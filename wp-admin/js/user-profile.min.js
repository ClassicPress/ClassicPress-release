!function(s){var e,a,t,n,i,r,o,d,p,l,c=!1,u=wp.i18n.__;function h(){"function"==typeof zxcvbn?(!a.val()||l.hasClass("is-open")?(a.val(a.data("pw")),a.trigger("pwupdate"),b()):(g(),b()),w(),1!==parseInt(r.data("start-masked"),10)?a.attr("type","text"):r.trigger("click"),s("#pw-weak-text-label").text(u("Confirm use of weak password")),s(a).trigger("focus")):setTimeout(h,50)}function f(s){r.attr({"aria-label":u(s?"Show password":"Hide password")}).find(".text").text(u(s?"Show":"Hide")).end().find(".dashicons").removeClass(s?"dashicons-hidden":"dashicons-visibility").addClass(s?"dashicons-visibility":"dashicons-hidden")}function w(){r||(r=e.find(".wp-hide-pw")).show().on("click",(function(){"password"===a.attr("type")?(a.attr("type","text"),f(!1)):(a.attr("type","password"),f(!0))}))}function m(e,a,t){var n=s("<div />");n.addClass("notice inline"),n.addClass("notice-"+(a?"success":"error")),n.text(s(s.parseHTML(t)).text()).wrapInner("<p />"),e.prop("disabled",a),e.siblings(".notice").remove(),e.before(n)}function v(){var r;e=s(".user-pass1-wrap, .user-pass-wrap, .reset-pass-submit"),s(".user-pass2-wrap").hide(),d=s("#submit, #wp-submit").on("click",(function(){c=!1})),o=d.add(" #createusersub"),n=s(".pw-weak"),(i=n.find(".pw-checkbox")).on("change",(function(){o.prop("disabled",!i.prop("checked"))})),(a=s("#pass1")).length?(p=a.val(),1===parseInt(a.data("reveal"),10)&&h(),a.on("input pwupdate",(function(){a.val()!==p&&(p=a.val(),a.removeClass("short bad good strong"),b())}))):a=s("#user_pass"),t=s("#pass2").on("input",(function(){t.val().length>0&&(a.val(t.val()),t.val(""),p="",a.trigger("pwupdate"))})),a.is(":hidden")&&(a.prop("disabled",!0),t.prop("disabled",!0)),l=e.find(".wp-pwd"),r=e.find("button.wp-generate-pw"),w(),r.show(),r.on("click",(function(){c=!0,r.not(".skip-aria-expanded").attr("aria-expanded","true"),l.show().addClass("is-open"),a.attr("disabled",!1),t.attr("disabled",!1),h(),f(!1),wp.ajax.post("generate-password").done((function(s){a.data("pw",s)}))})),e.find("button.wp-cancel-pw").on("click",(function(){c=!1,a.prop("disabled",!0),t.prop("disabled",!0),a.val("").trigger("pwupdate"),f(!1),l.hide().removeClass("is-open"),o.prop("disabled",!1),r.attr("aria-expanded","false")})),e.closest("form").on("submit",(function(){c=!1,a.prop("disabled",!1),t.prop("disabled",!1),t.val(a.val())}))}function g(){var e=s("#pass1").val();if(s("#pass-strength-result").removeClass("short bad good strong empty"),e&&""!==e.trim())switch(wp.passwordStrength.meter(e,wp.passwordStrength.userInputDisallowedList(),e)){case-1:s("#pass-strength-result").addClass("bad").html(pwsL10n.unknown);break;case 2:s("#pass-strength-result").addClass("bad").html(pwsL10n.bad);break;case 3:s("#pass-strength-result").addClass("good").html(pwsL10n.good);break;case 4:s("#pass-strength-result").addClass("strong").html(pwsL10n.strong);break;case 5:s("#pass-strength-result").addClass("short").html(pwsL10n.mismatch);break;default:s("#pass-strength-result").addClass("short").html(pwsL10n.short)}else s("#pass-strength-result").addClass("empty").html("&nbsp;")}function b(){var e=s("#pass-strength-result")[0];e.className&&(a.addClass(e.className),s(e).is(".short, .bad")?(i.prop("checked")||o.prop("disabled",!0),n.show()):(s(e).is(".empty")?(o.prop("disabled",!0),i.prop("checked",!1)):o.prop("disabled",!1),n.hide()))}s((function(){var e,a,t,n,i=s("#display_name"),r=i.val(),o=s("#wp-admin-bar-my-account").find(".display-name");s("#pass1").val("").on("input pwupdate",g),s("#pass-strength-result").show(),s(".color-palette").on("click",(function(){s(this).siblings('input[name="admin_color"]').prop("checked",!0)})),i.length&&(s("#first_name, #last_name, #nickname").on("blur.user_profile",(function(){var e=[],a={display_nickname:s("#nickname").val()||"",display_username:s("#user_login").val()||"",display_firstname:s("#first_name").val()||"",display_lastname:s("#last_name").val()||""};a.display_firstname&&a.display_lastname&&(a.display_firstlast=a.display_firstname+" "+a.display_lastname,a.display_lastfirst=a.display_lastname+" "+a.display_firstname),s.each(s("option",i),(function(s,a){e.push(a.value)})),s.each(a,(function(t,n){if(n){var r=n.replace(/<\/?[a-z][^>]*>/gi,"");a[t].length&&-1===s.inArray(r,e)&&(e.push(r),s("<option />",{text:r}).appendTo(i))}}))})),i.on("change",(function(){if(t===n){var s=this.value.trim()||r;o.text(s)}}))),e=s("#color-picker"),a=s("#colors-css"),t=s("input#user_id").val(),n=s('input[name="checkuser_id"]').val(),e.on("click.colorpicker",".color-option",(function(){var e,i=s(this);if(!i.hasClass("selected")&&(i.siblings(".selected").removeClass("selected"),i.addClass("selected").find('input[type="radio"]').prop("checked",!0),t===n)){if(0===a.length&&(a=s('<link rel="stylesheet" />').appendTo("head")),a.attr("href",i.children(".css_url").val()),"undefined"!=typeof wp&&wp.svgPainter){try{e=JSON.parse(i.children(".icon_colors").val())}catch(r){}e&&(wp.svgPainter.setColors(e),wp.svgPainter.paint())}s.post(ajaxurl,{action:"save-user-color-scheme",color_scheme:i.children('input[name="admin_color"]').val(),nonce:s("#color-nonce").val()}).done((function(e){e.success&&s("body").removeClass(e.data.previousScheme).addClass(e.data.currentScheme)}))}})),v(),s("#generate-reset-link").on("click",(function(){var e=s(this),a={user_id:userProfileL10n.user_id,nonce:userProfileL10n.nonce};e.parent().find(".notice-error").remove();var t=wp.ajax.post("send-password-reset",a);t.done((function(s){m(e,!0,s)})),t.fail((function(s){m(e,!1,s)}))}))})),s("#destroy-sessions").on("click",(function(e){var a=s(this);wp.ajax.post("destroy-sessions",{nonce:s("#_wpnonce").val(),user_id:s("#user_id").val()}).done((function(s){a.prop("disabled",!0),a.siblings(".notice").remove(),a.before('<div class="notice notice-success inline"><p>'+s.message+"</p></div>")})).fail((function(s){a.siblings(".notice").remove(),a.before('<div class="notice notice-error inline"><p>'+s.message+"</p></div>")})),e.preventDefault()})),window.generatePassword=h,s(window).on("beforeunload",(function(){if(!0===c)return u("Your new password has not been saved.")})),s((function(){s(".reset-pass-submit").length&&s(".reset-pass-submit button.wp-generate-pw").trigger("click")}))}(jQuery);