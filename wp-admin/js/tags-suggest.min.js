!function(e){if("undefined"!=typeof window.uiAutocompleteL10n){var t=0,o=wp.i18n._x(",","tag delimiter")||",";e.fn.wpTagsSuggest=function(a){var i,r,u=e(this);if(!u.length)return this;var s=(a=a||{}).taxonomy||u.attr("data-wp-taxonomy")||"post_tag";return delete a.taxonomy,a=e.extend({source:function(o,a){var l;r!==o.term?(l=function(e){return n(e).pop()}(o.term),e.get(window.ajaxurl,{action:"ajax-tag-search",tax:s,q:l,number:20}).always((function(){u.removeClass("ui-autocomplete-loading")})).done((function(e){var o,n=[];if(e){for(o in e=e.split("\n")){var r=++t;n.push({id:r,name:e[o]})}i=n,a(n)}else a(n)})),r=o.term):a(i)},focus:function(e,t){u.attr("aria-activedescendant","wp-tags-autocomplete-"+t.item.id),e.preventDefault()},select:function(t,a){var i=n(u.val());return i.pop(),i.push(a.item.name,""),u.val(i.join(o+" ")),e.ui.keyCode.TAB===t.keyCode?(window.wp.a11y.speak(wp.i18n.__("Term selected."),"assertive"),t.preventDefault()):e.ui.keyCode.ENTER===t.keyCode&&(window.tagBox&&(window.tagBox.userAction="add",window.tagBox.flushTags(e(this).closest(".tagsdiv"))),t.preventDefault(),t.stopPropagation()),!1},open:function(){u.attr("aria-expanded","true")},close:function(){u.attr("aria-expanded","false")},minLength:2,position:{my:"left top+2",at:"left bottom",collision:"none"},messages:{noResults:window.uiAutocompleteL10n.noResults,results:function(e){return e>1?window.uiAutocompleteL10n.manyResults.replace("%d",e):window.uiAutocompleteL10n.oneResult}}},a),u.on("keydown",(function(){u.removeAttr("aria-activedescendant")})),u.autocomplete(a),u.autocomplete("instance")?(u.autocomplete("instance")._renderItem=function(t,o){return e('<li role="option" id="wp-tags-autocomplete-'+o.id+'">').text(o.name).appendTo(t)},u.attr({role:"combobox","aria-autocomplete":"list","aria-expanded":"false","aria-owns":u.autocomplete("widget").attr("id")}).on("focus",(function(){n(u.val()).pop()&&u.autocomplete("search")})),u.autocomplete("widget").addClass("wp-tags-autocomplete").attr("role","listbox").removeAttr("tabindex").on("menufocus",(function(e,t){t.item.attr("aria-selected","true")})).on("menublur",(function(){e(this).find('[aria-selected="true"]').removeAttr("aria-selected")})),this):this}}function n(e){return e.split(new RegExp(o+"\\s*"))}}(jQuery);