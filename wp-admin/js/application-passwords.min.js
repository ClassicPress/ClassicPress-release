!function(e){var s=e("#application-passwords-section"),a=s.find(".create-application-password"),i=a.find(".input"),o=a.find(".button"),t=s.find(".application-passwords-list-table-wrapper"),n=s.find("tbody"),p=n.find(".no-items"),r=e("#revoke-all-application-passwords"),d=wp.template("new-application-password"),l=wp.template("application-password-row"),c=e("#user_id").val();function u(e,s,a){var i=a;e.responseJSON&&e.responseJSON.message&&(i=e.responseJSON.message),w(i,"error")}function w(s,i){var o=e("<div></div>").attr("role","alert").attr("tabindex","-1").addClass("is-dismissible notice notice-"+i).append(e("<p></p>").text(s)).append(e("<button></button>").attr("type","button").addClass("notice-dismiss").append(e("<span></span>").addClass("screen-reader-text").text(wp.i18n.__("Dismiss this notice."))));return a.after(o),o}function f(){e(".notice",s).remove()}o.on("click",(function(s){if(s.preventDefault(),!o.prop("aria-disabled")){var r=i.val();if(0!==r.length){f(),o.prop("aria-disabled",!0).addClass("disabled");var w={name:r};w=wp.hooks.applyFilters("wp_application_passwords_new_password_request",w,c),wp.apiRequest({path:"/wp/v2/users/"+c+"/application-passwords?_locale=user",method:"POST",data:w}).always((function(){o.removeProp("aria-disabled").removeClass("disabled")})).done((function(s){i.val(""),o.prop("disabled",!1),a.after(d({name:s.name,password:s.password})),e(".new-application-password-notice").trigger("focus"),n.prepend(l(s)),t.show(),p.remove(),wp.hooks.doAction("wp_application_passwords_created_password",s,w)})).fail(u)}else i.trigger("focus")}})),n.on("click",".delete",(function(s){if(s.preventDefault(),window.confirm(wp.i18n.__("Are you sure you want to revoke this password? This action cannot be undone."))){var a=e(this),i=a.closest("tr"),o=i.data("uuid");f(),a.prop("disabled",!0),wp.apiRequest({path:"/wp/v2/users/"+c+"/application-passwords/"+o+"?_locale=user",method:"DELETE"}).always((function(){a.prop("disabled",!1)})).done((function(e){e.deleted&&(0===i.siblings().length&&t.hide(),i.remove(),w(wp.i18n.__("Application password revoked."),"success").trigger("focus"))})).fail(u)}})),r.on("click",(function(a){if(a.preventDefault(),window.confirm(wp.i18n.__("Are you sure you want to revoke all passwords? This action cannot be undone."))){var i=e(this);f(),i.prop("disabled",!0),wp.apiRequest({path:"/wp/v2/users/"+c+"/application-passwords?_locale=user",method:"DELETE"}).always((function(){i.prop("disabled",!1)})).done((function(e){e.deleted&&(n.children().remove(),s.children(".new-application-password").remove(),t.hide(),w(wp.i18n.__("All application passwords revoked."),"success").trigger("focus"))})).fail(u)}})),s.on("click",".notice-dismiss",(function(s){s.preventDefault();var a=e(this).parent();a.removeAttr("role"),a.fadeTo(100,0,(function(){a.slideUp(100,(function(){a.remove(),i.trigger("focus")}))}))})),i.on("keypress",(function(e){13===e.which&&(e.preventDefault(),o.trigger("click"))})),0===n.children("tr").not(p).length&&t.hide()}(jQuery);