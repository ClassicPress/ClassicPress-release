!function(t){var e=wp.i18n._x(",","tag delimiter")||",";window.array_unique_noempty=function(e){var a=[];return t.each(e,(function(e,i){(i=(i=i||"").trim())&&-1===t.inArray(i,a)&&a.push(i)})),a},window.tagBox={clean:function(t){return","!==e&&(t=t.replace(new RegExp(e,"g"),",")),t=t.replace(/\s*,\s*/g,",").replace(/,+/g,",").replace(/[,\s]+$/,"").replace(/^[,\s]+/,""),","!==e&&(t=t.replace(/,/g,e)),t},parseTags:function(a){var i=a.id.split("-check-num-")[1],n=t(a).closest(".tagsdiv"),s=n.find(".the-tags"),c=s.val().split(e),o=[];return delete c[i],t.each(c,(function(t,e){(e=(e=e||"").trim())&&o.push(e)})),s.val(this.clean(o.join(e))),this.quickClicks(n),!1},quickClicks:function(a){var i,n,s=t(".the-tags",a),c=t(".tagchecklist",a),o=t(a).attr("id");s.length&&(n=s.prop("disabled"),i=s.val().split(e),c.empty(),t.each(i,(function(e,a){var i,s;(a=(a=a||"").trim())&&(i=t("<li />").text(a),n||((s=t('<button type="button" id="'+o+"-check-num-"+e+'" class="ntdelbutton"><span class="remove-tag-icon" aria-hidden="true"></span><span class="screen-reader-text">'+wp.i18n.__("Remove term:")+" "+i.html()+"</span></button>")).on("click keypress",(function(e){"click"!==e.type&&13!==e.keyCode&&32!==e.keyCode||(13!==e.keyCode&&32!==e.keyCode||t(this).closest(".tagsdiv").find("input.newtag").trigger("focus"),tagBox.userAction="remove",tagBox.parseTags(this))})),i.prepend("&nbsp;").prepend(s)),c.append(i))})),tagBox.screenReadersMessage())},flushTags:function(a,i,n){var s,c,o,r=t(".the-tags",a),u=t("input.newtag",a);return void 0===(o=(i=i||!1)?t(i).text():u.val())||""===o||(c=(s=r.val())?s+e+o:o,c=this.clean(c),c=array_unique_noempty(c.split(e)).join(e),r.val(c),this.quickClicks(a),i||u.val(""),void 0===n&&u.trigger("focus")),!1},get:function(e){var a=e.substr(e.indexOf("-")+1);t.post(ajaxurl,{action:"get-tagcloud",tax:a},(function(i,n){0!==i&&"success"==n&&(i=t('<div id="tagcloud-'+a+'" class="the-tagcloud">'+i+"</div>"),t("a",i).on("click",(function(){return tagBox.userAction="add",tagBox.flushTags(t("#"+a),this),!1})),t("#"+e).after(i))}))},userAction:"",screenReadersMessage:function(){var t;switch(this.userAction){case"remove":t=wp.i18n.__("Term removed.");break;case"add":t=wp.i18n.__("Term added.");break;default:return}window.wp.a11y.speak(t,"assertive")},init:function(){var e=t("div.ajaxtag");t(".tagsdiv").each((function(){tagBox.quickClicks(this)})),t(".tagadd",e).on("click",(function(){tagBox.userAction="add",tagBox.flushTags(t(this).closest(".tagsdiv"))})),t("input.newtag",e).on("keypress",(function(e){13==e.which&&(tagBox.userAction="add",tagBox.flushTags(t(this).closest(".tagsdiv")),e.preventDefault(),e.stopPropagation())})).each((function(e,a){t(a).wpTagsSuggest()})),t("#post").on("submit",(function(){t("div.tagsdiv").each((function(){tagBox.flushTags(this,!1,1)}))})),t(".tagcloud-link").on("click",(function(){tagBox.get(t(this).attr("id")),t(this).attr("aria-expanded","true").off().on("click",(function(){t(this).attr("aria-expanded","false"===t(this).attr("aria-expanded")?"true":"false").siblings(".the-tagcloud").toggle()}))}))}}}(jQuery);