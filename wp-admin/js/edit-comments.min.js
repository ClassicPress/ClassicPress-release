var setCommentsList,theList,theExtraList,commentReply;!function(t){var e,n,a,o,s,i,r,l,m,c=document.title,p=t("#dashboard_right_now").length;e=function(t){var e=parseInt(t.html().replace(/[^0-9]+/g,""),10);return isNaN(e)?0:e},n=function(t,e){var n="";if(!isNaN(e)){if((e=e<1?"0":e.toString()).length>3){for(;e.length>3;)n=thousandsSeparator+e.substr(e.length-3)+n,e=e.substr(0,e.length-3);e+=n}t.html(e)}},s=function(o,s){var i,r,l=".post-com-count-"+s,m="comment-count-no-comments",c="comment-count-approved";a("span.approved-count",o),s&&(i=t("span."+c,l),r=t("span."+m,l),i.each((function(){var a=t(this),s=e(a)+o;s<1&&(s=0),0===s?a.removeClass(c).addClass(m):a.addClass(c).removeClass(m),n(a,s)})),r.each((function(){var e=t(this);o>0?e.removeClass(m).addClass(c):e.addClass(m).removeClass(c),n(e,o)})))},a=function(a,o){t(a).each((function(){var a=t(this),s=e(a)+o;s<1&&(s=0),n(a,s)}))},r=function(e){if(p&&e&&e.i18n_comments_text){var n=t("#dashboard_right_now");t(".comment-count a",n).text(e.i18n_comments_text),t(".comment-mod-count a",n).text(e.i18n_moderation_text).parent()[e.in_moderation>0?"removeClass":"addClass"]("hidden")}},i=function(a){var o,s,i,r;m=m||new RegExp(adminCommentsL10n.docTitleCommentsCount.replace("%s","\\([0-9"+thousandsSeparator+"]+\\)")+"?"),l=l||t("<div />"),o=c,(r=m.exec(document.title))?(r=r[0],l.html(r),i=e(l)+a):(l.html(0),i=a),i>=1?(n(l,i),(s=m.exec(document.title))&&(o=document.title.replace(s[0],adminCommentsL10n.docTitleCommentsCount.replace("%s",l.text())+" "))):(s=m.exec(o))&&(o=o.replace(s[0],adminCommentsL10n.docTitleComments)),document.title=o},o=function(a,o){var s,r,l=".post-com-count-"+o,m="comment-count-no-pending",c="post-com-count-no-pending",d="comment-count-pending";p||i(a),t("span.pending-count").each((function(){var o=t(this),s=e(o)+a;s<1&&(s=0),o.closest(".awaiting-mod")[0===s?"addClass":"removeClass"]("count-0"),n(o,s)})),o&&(s=t("span."+d,l),r=t("span."+m,l),s.each((function(){var o=t(this),s=e(o)+a;s<1&&(s=0),0===s?(o.parent().addClass(c),o.removeClass(d).addClass(m)):(o.parent().removeClass(c),o.addClass(d).removeClass(m)),n(o,s)})),r.each((function(){var e=t(this);a>0?(e.parent().removeClass(c),e.removeClass(m).addClass(d)):(e.parent().addClass(c),e.addClass(m).removeClass(d)),n(e,a)})))},setCommentsList=function(){var n,i,l,m,c,d,u,h,f,v=0;n=t('input[name="_total"]',"#comments-form"),i=t('input[name="_per_page"]',"#comments-form"),l=t('input[name="_page"]',"#comments-form"),d=function(t,e,a){e<v||(a&&(v=e),n.val(t.toString()))},m=function(e,n){var a,i,l,m,c=t("#"+n.element);!0!==n.parsed&&(m=n.parsed.responses[0]),a=t("#replyrow"),i=t("#comment_ID",a).val(),l=t("#replybtn",a),c.is(".unapproved")?(n.data.id==i&&l.text(adminCommentsL10n.replyApprove),c.find(".row-actions span.view").addClass("hidden").end().find("div.comment_status").html("0")):(n.data.id==i&&l.text(adminCommentsL10n.reply),c.find(".row-actions span.view").removeClass("hidden").end().find("div.comment_status").html("1")),f=t("#"+n.element).is("."+n.dimClass)?1:-1,m?(r(m.supplemental),o(f,m.supplemental.postId),s(-1*f,m.supplemental.postId)):(o(f),s(-1*f))},c=function(e,a){var o,s,r,m,c,p,d,u=!1,h=t(e.target).attr("data-wp-lists");return e.data._total=n.val()||0,e.data._per_page=i.val()||0,e.data._page=l.val()||0,e.data._url=document.location.href,e.data.comment_status=t('input[name="comment_status"]',"#comments-form").val(),-1!=h.indexOf(":trash=1")?u="trash":-1!=h.indexOf(":spam=1")&&(u="spam"),u&&(s=h.replace(/.*?comment-([0-9]+).*/,"$1"),r=t("#comment-"+s),o=t("#"+u+"-undo-holder").html(),r.find(".check-column :checkbox").prop("checked",!1),r.siblings("#replyrow").length&&commentReply.cid==s&&commentReply.close(),r.is("tr")?(m=r.children(":visible").length,d=t(".author strong",r).text(),c=t('<tr id="undo-'+s+'" class="undo un'+u+'" style="display:none;"><td colspan="'+m+'">'+o+"</td></tr>")):(d=t(".comment-author",r).text(),c=t('<div id="undo-'+s+'" style="display:none;" class="undo un'+u+'">'+o+"</div>")),r.before(c),t("strong","#undo-"+s).text(d),(p=t(".undo a","#undo-"+s)).attr("href","comment.php?action=un"+u+"comment&c="+s+"&_wpnonce="+e.data._ajax_nonce),p.attr("data-wp-lists","delete:the-comment-list:comment-"+s+"::un"+u+"=1"),p.attr("class","vim-z vim-destructive"),t(".avatar",r).first().clone().prependTo("#undo-"+s+" ."+u+"-undo-inside"),p.click((function(e){e.preventDefault(),e.stopPropagation(),a.wpList.del(this),t("#undo-"+s).css({backgroundColor:"#ceb"}).fadeOut(350,(function(){t(this).remove(),t("#comment-"+s).css("backgroundColor","").fadeIn(300,(function(){t(this).show()}))}))}))),e},u=function(i,l){var m,c,u,f,g,y,C,_,w=!0===l.parsed?{}:l.parsed.responses[0],x=!0===l.parsed?"":w.supplemental.status,b=!0===l.parsed?"":w.supplemental.postId,k=!0===l.parsed?"":w.supplemental,L=t(l.target).parent(),E=t("#"+l.element),I=E.hasClass("approved"),R=E.hasClass("unapproved"),T=E.hasClass("spam"),j=E.hasClass("trash"),D=!1;r(k),L.is("span.undo")?(L.hasClass("unspam")?(g=-1,"trash"===x?y=1:"1"===x?_=1:"0"===x&&(C=1)):L.hasClass("untrash")&&(y=-1,"spam"===x?g=1:"1"===x?_=1:"0"===x&&(C=1)),D=!0):L.is("span.spam")?(I?_=-1:R?C=-1:j&&(y=-1),g=1):L.is("span.unspam")?(I?C=1:R?_=1:(j||T)&&(L.hasClass("approve")?_=1:L.hasClass("unapprove")&&(C=1)),g=-1):L.is("span.trash")?(I?_=-1:R?C=-1:T&&(g=-1),y=1):L.is("span.untrash")?(I?C=1:R?_=1:j&&(L.hasClass("approve")?_=1:L.hasClass("unapprove")&&(C=1)),y=-1):L.is("span.approve:not(.unspam):not(.untrash)")?(_=1,C=-1):L.is("span.unapprove:not(.unspam):not(.untrash)")?(_=-1,C=1):L.is("span.delete")&&(T?g=-1:j&&(y=-1)),C&&(o(C,b),a("span.all-count",C)),_&&(s(_,b),a("span.all-count",_)),g&&a("span.spam-count",g),y&&a("span.trash-count",y),("trash"===l.data.comment_status&&!e(t("span.trash-count"))||"spam"===l.data.comment_status&&!e(t("span.spam-count")))&&t("#delete_all").hide(),p||(c=n.val()?parseInt(n.val(),10):0,t(l.target).parent().is("span.undo")?c++:c--,c<0&&(c=0),"object"==typeof i?w.supplemental.total_items_i18n&&v<w.supplemental.time?((m=w.supplemental.total_items_i18n||"")&&(t(".displaying-num").text(m),t(".total-pages").text(w.supplemental.total_pages_i18n),t(".tablenav-pages").find(".next-page, .last-page").toggleClass("disabled",w.supplemental.total_pages==t(".current-page").val())),d(c,w.supplemental.time,!0)):w.supplemental.time&&d(c,w.supplemental.time,!1):d(c,i,!1)),theExtraList&&0!==theExtraList.length&&0!==theExtraList.children().length&&!D&&(theList.get(0).wpList.add(theExtraList.children(":eq(0):not(.no-items)").remove().clone()),h(),f=function(){t("#the-comment-list tr:visible").length||theList.get(0).wpList.add(theExtraList.find(".no-items").clone())},(u=t(":animated","#the-comment-list")).length?u.promise().done(f):f())},h=function(e){var n=t.query.get(),a=t(".total-pages").text(),o=t('input[name="_per_page"]',"#comments-form").val();n.paged||(n.paged=1),n.paged>a||(e?(theExtraList.empty(),n.number=Math.min(8,o)):(n.number=1,n.offset=Math.min(8,o)-1),n.no_placeholder=!0,n.paged++,!0===n.comment_type&&(n.comment_type=""),n=t.extend(n,{action:"fetch-list",list_args:list_args,_ajax_fetch_list_nonce:t("#_ajax_fetch_list_nonce").val()}),t.ajax({url:ajaxurl,global:!1,dataType:"json",data:n,success:function(t){theExtraList.get(0).wpList.add(t.rows)}}))},theExtraList=t("#the-extra-comment-list").wpList({alt:"",delColor:"none",addColor:"none"}),theList=t("#the-comment-list").wpList({alt:"",delBefore:c,dimAfter:m,delAfter:u,addColor:"none"}).bind("wpListDelEnd",(function(e,n){var a=t(n.target).attr("data-wp-lists"),o=n.element.replace(/[^0-9]+/g,"");-1==a.indexOf(":trash=1")&&-1==a.indexOf(":spam=1")||t("#undo-"+o).fadeIn(300,(function(){t(this).show()}))}))},commentReply={cid:"",act:"",originalContent:"",init:function(){var e=t("#replyrow");t("a.cancel",e).click((function(){return commentReply.revert()})),t("a.save",e).click((function(){return commentReply.send()})),t("input#author-name, input#author-email, input#author-url",e).keypress((function(t){if(13==t.which)return commentReply.send(),t.preventDefault(),!1})),t("#the-comment-list .column-comment > p").dblclick((function(){commentReply.toggle(t(this).parent())})),t("#doaction, #post-query-submit").click((function(){t("#the-comment-list #replyrow").length>0&&commentReply.close()})),this.comments_listing=t('#comments-form > input[name="comment_status"]').val()||""},addEvents:function(e){e.each((function(){t(this).find(".column-comment > p").dblclick((function(){commentReply.toggle(t(this).parent())}))}))},toggle:function(e){"none"!==t(e).css("display")&&(t("#replyrow").parent().is("#com-reply")||window.confirm(adminCommentsL10n.warnQuickEdit))&&t(e).find("button.vim-q").click()},revert:function(){return t("#the-comment-list #replyrow").length<1||t("#replyrow").fadeOut("fast",(function(){commentReply.close()})),!1},close:function(){var e=t(),n=t("#replyrow");n.parent().is("#com-reply")||(this.cid&&(e=t("#comment-"+this.cid)),"edit-comment"===this.act&&e.fadeIn(300,(function(){e.show().find(".vim-q").attr("aria-expanded","false").focus()})).css("backgroundColor",""),"replyto-comment"===this.act&&e.find(".vim-r").attr("aria-expanded","false").focus(),"undefined"!=typeof QTags&&QTags.closeAllTags("replycontent"),t("#add-new-comment").css("display",""),n.hide(),t("#com-reply").append(n),t("#replycontent").css("height","").val(""),t("#edithead input").val(""),t(".notice-error",n).addClass("hidden").find(".error").empty(),t(".spinner",n).removeClass("is-active"),this.cid="",this.originalContent="")},open:function(e,n,a){var o,s,i,r,l,m,c=this,p=t("#comment-"+e),d=p.height();return!!this.discardCommentChanges()&&(c.close(),c.cid=e,o=t("#replyrow"),s=t("#inline-"+e),i="edit"==(a=a||"replyto")?"edit":"replyto",i=c.act=i+"-comment",c.originalContent=t("textarea.comment",s).val(),m=t("> th:visible, > td:visible",p).length,o.hasClass("inline-edit-row")&&0!==m&&t("td",o).attr("colspan",m),t("#action",o).val(i),t("#comment_post_ID",o).val(n),t("#comment_ID",o).val(e),"edit"==a?(t("#author-name",o).val(t("div.author",s).text()),t("#author-email",o).val(t("div.author-email",s).text()),t("#author-url",o).val(t("div.author-url",s).text()),t("#status",o).val(t("div.comment_status",s).text()),t("#replycontent",o).val(t("textarea.comment",s).val()),t("#edithead, #editlegend, #savebtn",o).show(),t("#replyhead, #replybtn, #addhead, #addbtn",o).hide(),d>120&&(l=d>500?500:d,t("#replycontent",o).css("height",l+"px")),p.after(o).fadeOut("fast",(function(){t("#replyrow").fadeIn(300,(function(){t(this).show()}))}))):"add"==a?(t("#addhead, #addbtn",o).show(),t("#replyhead, #replybtn, #edithead, #editlegend, #savebtn",o).hide(),t("#the-comment-list").prepend(o),t("#replyrow").fadeIn(300)):(r=t("#replybtn",o),t("#edithead, #editlegend, #savebtn, #addhead, #addbtn",o).hide(),t("#replyhead, #replybtn",o).show(),p.after(o),p.hasClass("unapproved")?r.text(adminCommentsL10n.replyApprove):r.text(adminCommentsL10n.reply),t("#replyrow").fadeIn(300,(function(){t(this).show()}))),setTimeout((function(){var e,n,a,o;n=(e=t("#replyrow").offset().top)+t("#replyrow").height(),(a=window.pageYOffset||document.documentElement.scrollTop)+(o=document.documentElement.clientHeight||window.innerHeight||0)-20<n?window.scroll(0,n-o+35):e-20<a&&window.scroll(0,e-35),t("#replycontent").focus().keyup((function(t){27==t.which&&commentReply.revert()}))}),600),!1)},send:function(){var e={};return t("#replysubmit .error-notice").addClass("hidden"),t("#replysubmit .spinner").addClass("is-active"),t("#replyrow input").not(":button").each((function(){var n=t(this);e[n.attr("name")]=n.val()})),e.content=t("#replycontent").val(),e.id=e.comment_post_ID,e.comments_listing=this.comments_listing,e.p=t('[name="p"]').val(),t("#comment-"+t("#comment_ID").val()).hasClass("unapproved")&&(e.approve_parent=1),t.ajax({type:"POST",url:ajaxurl,data:e,success:function(t){commentReply.show(t)},error:function(t){commentReply.error(t)}}),!1},show:function(e){var n,i,l,m,c,d=this;return"string"==typeof e?(d.error({responseText:e}),!1):(n=wpAjax.parseAjaxResponse(e)).errors?(d.error({responseText:wpAjax.broken}),!1):(d.revert(),l="#comment-"+(n=n.responses[0]).id,"edit-comment"==d.act&&t(l).remove(),void(n.supplemental.parent_approved&&(c=t("#comment-"+n.supplemental.parent_approved),o(-1,n.supplemental.parent_post_id),"moderated"==this.comments_listing)?c.animate({backgroundColor:"#CCEEBB"},400,(function(){c.fadeOut()})):(n.supplemental.i18n_comments_text&&(p?r(n.supplemental):(s(1,n.supplemental.parent_post_id),a("span.all-count",1))),i=t.trim(n.data),t(i).hide(),t("#replyrow").after(i),l=t(l),d.addEvents(l),m=l.hasClass("unapproved")?"#FFFFE0":l.closest(".widefat, .postbox").css("backgroundColor"),l.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:m},300,(function(){c&&c.length&&c.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:m},300).removeClass("unapproved").addClass("approved").find("div.comment_status").html("1")})))))},error:function(e){var n=e.statusText,a=t("#replysubmit .notice-error"),o=a.find(".error");t("#replysubmit .spinner").removeClass("is-active"),e.responseText&&(n=e.responseText.replace(/<.[^<>]*?>/g,"")),n&&(a.removeClass("hidden"),o.html(n))},addcomment:function(e){var n=this;t("#add-new-comment").fadeOut(200,(function(){n.open(0,e,"add"),t("table.comments-box").css("display",""),t("#no-comments").remove()}))},discardCommentChanges:function(){var e=t("#replyrow");return this.originalContent===t("#replycontent",e).val()||window.confirm(adminCommentsL10n.warnCommentChanges)}},t(document).ready((function(){var e,n,a,o;setCommentsList(),commentReply.init(),t(document).on("click","span.delete a.delete",(function(t){t.preventDefault()})),"undefined"!=typeof t.table_hotkeys&&(e=function(e){return function(){var n,a;n="next"==e?"first":"last",(a=t(".tablenav-pages ."+e+"-page:not(.disabled)")).length&&(window.location=a[0].href.replace(/\&hotkeys_highlight_(first|last)=1/g,"")+"&hotkeys_highlight_"+n+"=1")}},n=function(e,n){window.location=t("span.edit a",n).attr("href")},a=function(){t("#cb-select-all-1").data("wp-toggle",1).trigger("click").removeData("wp-toggle")},o=function(e){return function(){var n=t('select[name="action"]');t('option[value="'+e+'"]',n).prop("selected",!0),t("#doaction").click()}},t.table_hotkeys(t("table.widefat"),["a","u","s","d","r","q","z",["e",n],["shift+x",a],["shift+a",o("approve")],["shift+s",o("spam")],["shift+d",o("delete")],["shift+t",o("trash")],["shift+z",o("untrash")],["shift+u",o("unapprove")]],{highlight_first:adminCommentsL10n.hotkeys_highlight_first,highlight_last:adminCommentsL10n.hotkeys_highlight_last,prev_page_link_cb:e("prev"),next_page_link_cb:e("next"),hotkeys_opts:{disableInInput:!0,type:"keypress",noDisable:'.check-column input[type="checkbox"]'},cycle_expr:"#the-comment-list tr",start_row_index:0})),t("#the-comment-list").on("click",".comment-inline",(function(){var e=t(this),n="replyto";void 0!==e.data("action")&&(n=e.data("action")),t(this).attr("aria-expanded","true"),commentReply.open(e.data("commentId"),e.data("postId"),n)}))}))}(jQuery);