!function(t,e,o){"use strict";var i=e(t),n=e(document),s=e("#wpadminbar"),f=e("#wpfooter");e((function(){var o,a,d=e("#postdivrich"),c=e("#wp-content-wrap"),u=e("#wp-content-editor-tools"),r=e(),l=e(),p=e("#ed_toolbar"),g=e("#content"),h=g[0],m=0,w=e("#post-status-info"),H=e(),b=e(),v=e("#side-sortables"),x=e("#postbox-container-1"),y=e("#post-body"),T=t.wp.editor&&t.wp.editor.fullscreen,B=function(){},C=function(){},S=!1,O=!1,z=!1,E=!1,k=0,A=56,W=20,K=300,R=c.hasClass("tmce-active")?"tinymce":"html",Y=!!parseInt(t.getUserSetting("hidetb"),10),U={windowHeight:0,windowWidth:0,adminBarHeight:0,toolsHeight:0,menuBarHeight:0,visualTopHeight:0,textTopHeight:0,bottomHeight:0,statusBarHeight:0,sideSortablesHeight:0},D=t._.throttle((function(){var e=t.scrollX||document.documentElement.scrollLeft,o=t.scrollY||document.documentElement.scrollTop,i=parseInt(h.style.height,10);h.style.height="300px",h.scrollHeight>K&&(h.style.height=h.scrollHeight+"px"),void 0!==e&&t.scrollTo(e,o),h.scrollHeight<i&&X()}),300);function P(){var t=h.value.length;o&&!o.isHidden()||(o||"tinymce"!==R)&&(t<m?D():parseInt(h.style.height,10)<h.scrollHeight&&(h.style.height=Math.ceil(h.scrollHeight)+"px",X()),m=t)}function X(e){if(!T||!T.settings.visible){var a,d,h,m,B,C,_,R,D,X=i.scrollTop(),F=e&&e.type,I="scroll"!==F,L=o&&!o.isHidden(),M=K,V=y.offset().top,N=c.width();!I&&U.windowHeight||(D=i.width(),(U={windowHeight:i.height(),windowWidth:D,adminBarHeight:D>600?s.outerHeight():0,toolsHeight:u.outerHeight()||0,menuBarHeight:H.outerHeight()||0,visualTopHeight:r.outerHeight()||0,textTopHeight:p.outerHeight()||0,bottomHeight:w.outerHeight()||0,statusBarHeight:b.outerHeight()||0,sideSortablesHeight:v.height()||0}).menuBarHeight<3&&(U.menuBarHeight=0)),L||"resize"!==F||P(),L?(a=r,d=l,C=U.visualTopHeight):(a=p,d=g,C=U.textTopHeight),(L||a.length)&&(B=a.parent().offset().top,_=d.offset().top,(R=d.outerHeight())>(L?K+C:320)+5?((!S||I)&&X>=B-U.toolsHeight-U.adminBarHeight&&X<=B-U.toolsHeight-U.adminBarHeight+R-M?(S=!0,u.css({position:"fixed",top:U.adminBarHeight,width:N}),L&&H.length&&H.css({position:"fixed",top:U.adminBarHeight+U.toolsHeight,width:N-2-(L?0:a.outerWidth()-a.width())}),a.css({position:"fixed",top:U.adminBarHeight+U.toolsHeight+U.menuBarHeight,width:N-2-(L?0:a.outerWidth()-a.width())})):(S||I)&&(X<=B-U.toolsHeight-U.adminBarHeight?(S=!1,u.css({position:"absolute",top:0,width:N}),L&&H.length&&H.css({position:"absolute",top:0,width:N-2}),a.css({position:"absolute",top:U.menuBarHeight,width:N-2-(L?0:a.outerWidth()-a.width())})):X>=B-U.toolsHeight-U.adminBarHeight+R-M&&(S=!1,u.css({position:"absolute",top:R-M,width:N}),L&&H.length&&H.css({position:"absolute",top:R-M,width:N-2}),a.css({position:"absolute",top:R-M+U.menuBarHeight,width:N-2-(L?0:a.outerWidth()-a.width())}))),(!O||I&&Y)&&X+U.windowHeight<=_+R+U.bottomHeight+U.statusBarHeight+1?e&&e.deltaHeight>0&&e.deltaHeight<100?t.scrollBy(0,e.deltaHeight):L&&Y&&(O=!0,b.css({position:"fixed",bottom:U.bottomHeight,visibility:"",width:N-2}),w.css({position:"fixed",bottom:0,width:N})):(!Y&&O||(O||I)&&X+U.windowHeight>_+R+U.bottomHeight+U.statusBarHeight-1)&&(O=!1,b.attr("style",Y?"":"visibility: hidden;"),w.attr("style",""))):I&&(u.css({position:"absolute",top:0,width:N}),L&&H.length&&H.css({position:"absolute",top:0,width:N-2}),a.css({position:"absolute",top:U.menuBarHeight,width:N-2-(L?0:a.outerWidth()-a.width())}),b.attr("style",Y?"":"visibility: hidden;"),w.attr("style","")),x.width()<300&&U.windowWidth>600&&n.height()>v.height()+V+120&&U.windowHeight<R?(U.sideSortablesHeight+A+W>U.windowHeight||z||E?X+A<=V?(v.attr("style",""),z=E=!1):X>k?z?(z=!1,h=v.offset().top-U.adminBarHeight,(m=f.offset().top)<h+U.sideSortablesHeight+W&&(h=m-U.sideSortablesHeight-12),v.css({position:"absolute",top:h,bottom:""})):!E&&U.sideSortablesHeight+v.offset().top+W<X+U.windowHeight&&(E=!0,v.css({position:"fixed",top:"auto",bottom:W})):X<k&&(E?(E=!1,h=v.offset().top-W,(m=f.offset().top)<h+U.sideSortablesHeight+W&&(h=m-U.sideSortablesHeight-12),v.css({position:"absolute",top:h,bottom:""})):!z&&v.offset().top>=X+A&&(z=!0,v.css({position:"fixed",top:A,bottom:""}))):(X>=V-A?v.css({position:"fixed",top:A}):v.attr("style",""),z=E=!1),k=X):(v.attr("style",""),z=E=!1),I&&(c.css({paddingTop:U.toolsHeight}),L?l.css({paddingTop:U.visualTopHeight+U.menuBarHeight}):g.css({marginTop:U.textTopHeight})))}}function F(){P(),X()}function I(t){for(var e=1;e<6;e++)setTimeout(t,500*e)}function L(){t.pageYOffset&&t.pageYOffset>130&&t.scrollTo(t.pageXOffset,0),d.addClass("wp-editor-expand"),i.on("scroll.editor-expand resize.editor-expand",(function(t){X(t.type),clearTimeout(a),a=setTimeout(X,100)})),n.on("wp-collapse-menu.editor-expand postboxes-columnchange.editor-expand editor-classchange.editor-expand",X).on("postbox-toggled.editor-expand postbox-moved.editor-expand",(function(){!z&&!E&&t.pageYOffset>A&&(E=!0,t.scrollBy(0,-1),X(),t.scrollBy(0,1)),X()})).on("wp-window-resized.editor-expand",(function(){o&&!o.isHidden()?o.execCommand("wpAutoResize"):P()})),g.on("focus.editor-expand input.editor-expand propertychange.editor-expand",P),B(),T&&T.pubsub.subscribe("hidden",F),o&&(o.settings.wp_autoresize_on=!0,o.execCommand("wpAutoResizeOn"),o.isHidden()||o.execCommand("wpAutoResize")),o&&!o.isHidden()||P(),X(),n.trigger("editor-expand-on")}function M(){var s=parseInt(t.getUserSetting("ed_size",300),10);s<50?s=50:s>5e3&&(s=5e3),t.pageYOffset&&t.pageYOffset>130&&t.scrollTo(t.pageXOffset,0),d.removeClass("wp-editor-expand"),i.off(".editor-expand"),n.off(".editor-expand"),g.off(".editor-expand"),C(),T&&T.pubsub.unsubscribe("hidden",F),e.each([r,p,u,H,w,b,c,l,g,v],(function(t,e){e&&e.attr("style","")})),S=O=z=E=!1,o&&(o.settings.wp_autoresize_on=!1,o.execCommand("wpAutoResizeOff"),o.isHidden()||(g.hide(),s&&o.theme.resizeTo(null,s))),s&&g.height(s),n.trigger("editor-expand-off")}n.on("tinymce-editor-init.editor-expand",(function(n,s){var f=t.tinymce.util.VK,a=_.debounce((function(){!e(".mce-floatpanel:hover").length&&t.tinymce.ui.FloatPanel.hideAll(),e(".mce-tooltip").hide()}),1e3,!0);function u(t){var e=t.keyCode;e<=47&&e!==f.SPACEBAR&&e!==f.ENTER&&e!==f.DELETE&&e!==f.BACKSPACE&&e!==f.UP&&e!==f.LEFT&&e!==f.DOWN&&e!==f.UP||e>=91&&e<=93||e>=112&&e<=123||144===e||145===e||p(e)}function p(e){var o,i,n,a,d=function(){var t,e,o,i=s.selection.getNode();if(s.wp&&s.wp.getView&&(e=s.wp.getView(i)))o=e.getBoundingClientRect();else{t=s.selection.getRng();try{o=t.getClientRects()[0]}catch(n){}o||(o=i.getBoundingClientRect())}return!!o.height&&o}();d&&(i=(o=d.top+s.iframeElement.getBoundingClientRect().top)+d.height,o-=50,i+=50,n=U.adminBarHeight+U.toolsHeight+U.menuBarHeight+U.visualTopHeight,(a=U.windowHeight-(Y?U.bottomHeight+U.statusBarHeight:0))-n<d.height||(o<n&&(e===f.UP||e===f.LEFT||e===f.BACKSPACE)?t.scrollTo(t.pageXOffset,o+t.pageYOffset-n):i>a&&t.scrollTo(t.pageXOffset,i+t.pageYOffset-a)))}function g(t){t.state||X()}function h(){i.on("scroll.mce-float-panels",a),setTimeout((function(){s.execCommand("wpAutoResize"),X()}),300)}function m(){i.off("scroll.mce-float-panels"),setTimeout((function(){var e=c.offset().top;t.pageYOffset>e&&t.scrollTo(t.pageXOffset,e-U.adminBarHeight),P(),X()}),100),X()}function w(){Y=!Y}"content"===s.id&&(o=s,s.settings.autoresize_min_height=K,r=c.find(".mce-toolbar-grp"),l=c.find(".mce-edit-area"),b=c.find(".mce-statusbar"),H=c.find(".mce-menubar"),B=function(){s.on("keyup",u),s.on("show",h),s.on("hide",m),s.on("wp-toolbar-toggle",w),s.on("setcontent wp-autoresize wp-toolbar-toggle",X),s.on("undo redo",p),s.on("FullscreenStateChanged",g),i.off("scroll.mce-float-panels").on("scroll.mce-float-panels",a)},C=function(){s.off("keyup",u),s.off("show",h),s.off("hide",m),s.off("wp-toolbar-toggle",w),s.off("setcontent wp-autoresize wp-toolbar-toggle",X),s.off("undo redo",p),s.off("FullscreenStateChanged",g),i.off("scroll.mce-float-panels")},d.hasClass("wp-editor-expand")&&(B(),I(X)))})),d.hasClass("wp-editor-expand")&&(L(),c.hasClass("html-active")&&I((function(){X(),P()}))),e("#adv-settings .editor-expand").show(),e("#editor-expand-toggle").on("change.editor-expand",(function(){e(this).prop("checked")?(L(),t.setUserSetting("editor_expand","on")):(M(),t.setUserSetting("editor_expand","off"))})),t.editorExpand={on:L,off:M}})),e((function(){var o,a,d,c,u,r,l,p,g,h,m,w=e(document.body),H=e("#wpcontent"),b=e("#post-body-content"),v=e("#title"),x=e("#content"),y=e(document.createElement("DIV")),T=e("#edit-slug-box"),B=T.find("a").add(T.find("button")).add(T.find("input")),C=e("#adminmenuwrap"),S=(e(),e(),"on"===t.getUserSetting("editor_expand","on")),O=!!S&&"on"===t.getUserSetting("post_dfw"),z=0,E=0,_=20;function k(){(c=b.offset()).right=c.left+b.outerWidth(),c.bottom=c.top+b.outerHeight()}function A(){S||(S=!0,n.trigger("dfw-activate"),x.on("keydown.focus-shortcut",I))}function W(){S&&(R(),S=!1,n.trigger("dfw-deactivate"),x.off("keydown.focus-shortcut"))}function K(){!O&&S&&(O=!0,x.on("keydown.focus",U),v.add(x).on("blur.focus",P),U(),t.setUserSetting("post_dfw","on"),n.trigger("dfw-on"))}function R(){O&&(O=!1,v.add(x).off(".focus"),D(),b.off(".focus"),t.setUserSetting("post_dfw","off"),n.trigger("dfw-off"))}function Y(){O?R():K()}function U(e){var n,f=e&&e.keyCode;t.navigator.platform&&(n=t.navigator.platform.indexOf("Mac")>-1),27===f||87===f&&e.altKey&&(!n&&e.shiftKey||n&&e.ctrlKey)?D(e):e&&(e.metaKey||e.ctrlKey&&!e.altKey||e.altKey&&e.shiftKey||f&&(f<=47&&8!==f&&13!==f&&32!==f&&46!==f||f>=91&&f<=93||f>=112&&f<=135||f>=144&&f<=150||f>=224))||(o||(o=!0,clearTimeout(h),h=setTimeout((function(){y.show()}),600),b.css("z-index",9998),y.on("mouseenter.focus",(function(){k(),i.on("scroll.focus",(function(){var e=t.pageYOffset;p&&l&&p!==e&&(l<c.top-_||l>c.bottom+_)&&D(),p=e}))})).on("mouseleave.focus",(function(){u=r=null,z=E=0,i.off("scroll.focus")})).on("mousemove.focus",(function(e){var o=e.clientX,i=e.clientY,n=t.pageYOffset,s=t.pageXOffset;if(u&&r&&(o!==u||i!==r))if(i<=r&&i<c.top-n||i>=r&&i>c.bottom-n||o<=u&&o<c.left-s||o>=u&&o>c.right-s){if(z+=Math.abs(u-o),E+=Math.abs(r-i),(i<=c.top-_-n||i>=c.bottom+_-n||o<=c.left-_-s||o>=c.right+_-s)&&(z>10||E>10))return D(),u=r=null,void(z=E=0)}else z=E=0;u=o,r=i})).on("touchstart.focus",(function(t){t.preventDefault(),D()})),b.off("mouseenter.focus"),g&&(clearTimeout(g),g=null),w.addClass("focus-on").removeClass("focus-off")),!a&&o&&(a=!0,s.on("mouseenter.focus",(function(){s.addClass("focus-off")})).on("mouseleave.focus",(function(){s.removeClass("focus-off")}))),X())}function D(t){o&&(o=!1,clearTimeout(h),h=setTimeout((function(){y.hide()}),200),b.css("z-index",""),y.off("mouseenter.focus mouseleave.focus mousemove.focus touchstart.focus"),void 0===t&&b.on("mouseenter.focus",(function(){(e.contains(b.get(0),document.activeElement)||m)&&U()})),g=setTimeout((function(){g=null,b.off("mouseenter.focus")}),1e3),w.addClass("focus-off").removeClass("focus-on")),a&&(a=!1,s.off(".focus")),F()}function P(){setTimeout((function(){var t=document.activeElement.compareDocumentPosition(b.get(0));function o(t){return e.contains(t.get(0),document.activeElement)}2!==t&&4!==t||!(o(C)||o(H)||o(f))||D()}),0)}function X(){d||!o||T.find(":focus").length||(d=!0,T.stop().fadeTo("fast",.3).on("mouseenter.focus",F).off("mouseleave.focus"),B.on("focus.focus",F).off("blur.focus"))}function F(){d&&(d=!1,T.stop().fadeTo("fast",1).on("mouseleave.focus",X).off("mouseenter.focus"),B.on("blur.focus",X).off("focus.focus"))}function I(t){t.altKey&&t.shiftKey&&87===t.keyCode&&Y()}w.append(y),y.css({display:"none",position:"fixed",top:s.height(),right:0,bottom:0,left:0,"z-index":9997}),b.css({position:"relative"}),i.on("mousemove.focus",(function(t){l=t.pageY})),e("#postdivrich").hasClass("wp-editor-expand")&&x.on("keydown.focus-shortcut",I),n.on("tinymce-editor-setup.focus",(function(t,e){e.addButton("dfw",{active:O,classes:"wp-dfw btn widget",disabled:!S,onclick:Y,onPostRender:function(){var t=this;n.on("dfw-activate.focus",(function(){t.disabled(!1)})).on("dfw-deactivate.focus",(function(){t.disabled(!0)})).on("dfw-on.focus",(function(){t.active(!0)})).on("dfw-off.focus",(function(){t.active(!1)}))},tooltip:"Distraction-free writing mode",shortcut:"Alt+Shift+W"}),e.addCommand("wpToggleDFW",Y),e.addShortcut("access+w","","wpToggleDFW")})),n.on("tinymce-editor-init.focus",(function(t,o){var i,s;function f(){m=!0}function a(){m=!1}"content"===o.id&&(e(o.getWin()),e(o.getContentAreaContainer()).find("iframe"),i=function(){o.on("keydown",U),o.on("blur",P),o.on("focus",f),o.on("blur",a),o.on("wp-autoresize",k)},s=function(){o.off("keydown",U),o.off("blur",P),o.off("focus",f),o.off("blur",a),o.off("wp-autoresize",k)},O&&i(),n.on("dfw-on.focus",i).on("dfw-off.focus",s),o.on("click",(function(t){t.target===o.getDoc().documentElement&&o.focus()})))})),n.on("quicktags-init",(function(t,o){var i;o.settings.buttons&&-1!==(","+o.settings.buttons+",").indexOf(",dfw,")&&(i=e("#"+o.name+"_dfw"),e(document).on("dfw-activate",(function(){i.prop("disabled",!1)})).on("dfw-deactivate",(function(){i.prop("disabled",!0)})).on("dfw-on",(function(){i.addClass("active")})).on("dfw-off",(function(){i.removeClass("active")})))})),n.on("editor-expand-on.focus",A).on("editor-expand-off.focus",W),O&&(x.on("keydown.focus",U),v.add(x).on("blur.focus",P)),t.wp=t.wp||{},t.wp.editor=t.wp.editor||{},t.wp.editor.dfw={activate:A,deactivate:W,isActive:function(){return S},on:K,off:R,toggle:Y,isOn:function(){return O}}}))}(window,window.jQuery);