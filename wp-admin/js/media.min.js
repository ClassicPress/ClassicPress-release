document.addEventListener("DOMContentLoaded",(function(){function e(e){var t=-1,n=e.previousElementSibling,o=document.querySelector(".container__suggestions"),i=document.getElementById("tags-list").value.split(", ");function a(){var t,n=e.value;for(t=e.selectionStart-1;t>=0&&!/\s/.test(n[t]);)t--;return t}function c(t){var n=e.value,o=e.selectionStart,i=a(),c=n.substring(0,i+1)+t+n.substring(o);e.value=c,e.focus(),e.selectionStart=e.selectionEnd=i+1+t.length}function l(e,t,n){return Math.min(Math.max(e,t),n)}e.addEventListener("scroll",(function(){n.scrollTop=e.scrollTop})),e.addEventListener("input",(function(){var t,l,d,s,r,u,m,p,y=e.value,f=e.selectionStart,v=a();""!==(t=y.substring(v+1,f))&&0!==(l=i.filter((function(e){return e.toLowerCase().indexOf(t.toLowerCase())>-1}))).length?(m=y.substring(0,f),p=y.substring(f),d=document.createTextNode(m),s=document.createTextNode(p),(r=document.createElement("span")).innerHTML="&nbsp;",n.innerHTML="",n.append(d,r,s),u=r.getBoundingClientRect(),o.style.top=`${u.top+u.height}px`,o.style.left=`${u.left}px`,o.innerHTML="",l.forEach((function(e){var t=document.createElement("div");t.innerText=e,t.classList.add("container__suggestion"),t.addEventListener("click",(function(){c(this.innerText),o.style.display="none"})),o.appendChild(t)})),o.style.display="block"):o.style.display="none"})),e.addEventListener("keydown",(function(e){var n,i;if(["ArrowDown","ArrowUp","Enter","Escape"].includes(e.key)&&0!==(i=(n=o.querySelectorAll(".container__suggestion")).length)&&"none"!==o.style.display)switch(e.preventDefault(),e.key){case"ArrowDown":n[l(0,t,i-1)].classList.remove("container__suggestion--focused"),n[t=l(0,t+1,i-1)].classList.add("container__suggestion--focused");break;case"ArrowUp":n[l(0,t,i-1)].classList.remove("container__suggestion--focused"),n[t=l(0,t-1,i-1)].classList.add("container__suggestion--focused");break;case"Enter":e.stopPropagation(),c(n[t].innerText),o.style.display="none";break;case"Escape":o.style.display="none"}}))}window.findPosts={open:function(e,t){var n=document.querySelector(".ui-find-overlay");return null==n&&((n=document.createElement("div")).className="ui-find-overlay",document.body.append(n),findPosts.overlay()),n.style.display="",e&&t&&(document.getElementById("affected").setAttribute("name",e),document.getElementById("affected").value=t),document.getElementById("find-posts").style.display="",document.getElementById("find-posts-input").addEventListener("keyup",(function(e){this.focus(),"Escape"===e.key&&findPosts.close()})),findPosts.send(),!1},close:function(){document.getElementById("find-posts-response").innerHTML="",document.getElementById("find-posts").style.display="none",document.querySelector(".ui-find-overlay").style.display="none"},overlay:function(){document.querySelector(".ui-find-overlay").addEventListener("click",(function(){findPosts.close()}))},send:function(){var e={ps:document.getElementById("find-posts-input").value,action:"find_posts",_ajax_nonce:document.getElementById("_ajax_nonce").value},t=document.querySelector(".find-box-search .spinner");t.classList.add("is-active"),fetch(ajaxurl,{method:"POST",body:new URLSearchParams(e),credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(e){t.classList.remove("is-active"),document.getElementById("find-posts-response").innerHTML=e.data}))["catch"]((function(){t.classList.remove("is-active"),document.getElementById("find-posts-response").textContent=wp.i18n.__("An error has occurred. Please reload the page and try again.")}))}};var t,n,o=document.getElementById("wp-media-grid"),i=document.getElementById("upload-category");if(null!=o&&window.wp&&window.wp.media){t=_wpMediaGridSettings;var a=window.wp.media({frame:"manage",container:o,library:t.queryVars}).open();o.dispatchEvent(new CustomEvent("wp-media-grid-ready",{detail:a}))}else document.getElementById("find-posts-submit").addEventListener("click",(function(e){for(var t=!1,n=document.querySelectorAll('#find-posts-response input[type="radio"]'),o=0,i=n.length;o<i;o++)if(n[o].checked){t=!0;break}!1===t&&e.preventDefault()}),!1),document.getElementById("find-posts-input").addEventListener("keydown",(function(e){"Enter"==e.key&&(e.preventDefault(),findPosts.send())}),!1),document.getElementById("find-posts-search").addEventListener("click",findPosts.send),document.getElementById("find-posts-close").addEventListener("click",findPosts.close),document.getElementById("doaction").addEventListener("click",(function(t){var n=document.getElementById("quick-edit"),o=document.getElementById("bulk-edit");o.style.display="none",document.body.append(o),n.style.display="none",document.body.append(n),document.querySelectorAll('select[name="action"]','select[name="action2"]').forEach((function(i){var a,c,l,d,s,r,u,m,p,y="",f=i.value,v=0,g=0,h=[...document.querySelector(".widefat thead tr").children],E=document.getElementById("cb-select-all-1"),b=document.getElementById("cb-select-all-2");"-1"===f?(t.preventDefault(),location.href=location.pathname):"attach"===f?(t.preventDefault(),findPosts.open()):"delete"===f?showNotice.warn()||t.preventDefault():"edit"===f&&(t.preventDefault(),c=document.querySelectorAll('tbody th.check-column input[type="checkbox"]'),(m=document.createElement("tr")).className="hidden",c.forEach((function(e){if(e.checked){var t=e.value,n=document.getElementById("post-"+t).querySelector(" .filename").innerHTML||wp.i18n.__("(no title)"),o=wp.i18n.sprintf(wp.i18n.__("Remove &#8220;%s&#8221; from Bulk Edit"),n);1===++v&&(a=document.getElementById("post-"+t)),y+='<li class="ntdelitem" name="attachment[]" value="'+t+'"><button type="button" id="_'+t+'" class="button-link ntdelbutton"><span class="screen-reader-text">'+o+'</span></button><span class="ntdeltitle" aria-hidden="true">'+n+"</span></li>"}})),h.forEach((function(e){e.className.includes("hidden")||g++})),o.querySelector("td").setAttribute("colspan",g),n.querySelector("td").setAttribute("colspan",g),v<1?(o.style.display="none",document.body.append(o),n.style.display="none",document.body.append(n)):1!==v||E.checked||b.checked?(document.querySelectorAll("tr").forEach((function(e){"none"===e.style.display&&(e.style.display="")})),document.getElementById("the-list").prepend(o),document.getElementById("the-list").prepend(m),o.classList.add("inline-editor"),o.style.display="",a.style.display="",e(o.querySelector("textarea")),document.getElementById("bulk-titles").innerHTML='<ul id="bulk-titles-list" role="list">'+y+"</ul>",o.scrollIntoView({behavior:"smooth"}),document.querySelectorAll("#bulk-titles .ntdelbutton").forEach((function(e){e.addEventListener("click",(function(){var t=e.id,n=e.parentNode,i=n.previousElementSibling?n.previousElementSibling.querySelector(".ntdelbutton"):null,a=n.nextElementSibling?n.nextElementSibling.querySelector(".ntdelbutton"):null;document.querySelector('table.widefat input[value="'+t.replace("_","")+'"]').checked=!1,document.getElementById(t).parentNode.remove(),wp.a11y.speak(wp.i18n.__("Item removed."),"assertive"),null!==a?a.focus():null!==i?i.focus():(m.remove(),document.getElementById("bulk-titles-list").remove(),o.style.display="none",document.body.append(o),wp.a11y.speak(wp.i18n.__("All selected items have been removed. Select new items to use Bulk Actions.")))}))})),document.getElementById("bulk-edit-update").addEventListener("click",(function(){m.remove()}))):(document.getElementById("the-list").prepend(m),n.dataset.id=a.id,a.before(n),n.classList.add("inline-editor"),n.style.display="",a.style.display="none",n.scrollIntoView({behavior:"smooth"}),d=a.querySelector(".column-author a").textContent,n.querySelectorAll("#quick-author option").forEach((function(e){e.textContent===d&&(document.getElementById("quick-author").value=e.value,e.setAttribute("selected","selected"))})),s=a.querySelectorAll(".column-taxonomy-media_category a"),r=[],s.forEach((function(e){r.push(e.textContent)})),n.querySelectorAll(".category-checklist li").forEach((function(e){r.includes(e.querySelector("label").textContent)&&(e.querySelector("input").checked=!0)})),u=a.querySelector(".column-taxonomy-media_post_tag a")?a.querySelector(".column-taxonomy-media_post_tag a").textContent:"",e(n.querySelector("textarea")),l=a.querySelector(".column-date").textContent.split("/"),n.querySelector('[name="mm"]').value=l[1],n.querySelector('[name="jj"]').value=l[2],n.querySelector('[name="aa"]').value=l[0],n.querySelector('[name="post_title"]').value=a.querySelector(".column-title strong a").textContent.trim(),n.querySelector('[name="post_name"]').value=a.querySelector(".column-title .row-actions .copy-attachment-url").dataset.clipboardText,n.querySelector("#quick-media-tags").textContent=u,n.querySelector('[name="alt"]').value=a.querySelector(".column-alt").textContent,n.querySelector('[name="post_excerpt"]').value=a.querySelector(".column-caption").textContent,n.querySelector('[name="post_content"]').value=a.querySelector(".column-desc").textContent,document.getElementById("quick-edit-update").addEventListener("click",(function(){var e=a.id.replace("post-","");!function(e,t){var n,o=e.querySelector("#quick-month"),i=e.querySelector("#quick-author"),a=e.querySelector("#quick-media-tags");"object"==typeof t&&(t=this.getId(t)),n=new URLSearchParams({action:"quick-edit-attachment",post_type:"attachment",id:t,edit_date:"true"}),e.querySelectorAll("input").forEach((function(e){"media_category[]"===e.name?e.checked&&n.append(e.name,e.value):n.append(e.name,e.value)})),n.append(o.name,o.value),n.append(i.name,i.value),n.append(a.name,a.value),fetch(ajaxurl,{method:"POST",body:n,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(t){e.nextElementSibling.innerHTML=t.data,wp.a11y.speak(wp.i18n.__("Changes saved."))}))["catch"]((function(){var t=e.querySelector(".inline-edit-save .notice-error"),n=t.querySelector(".error");t.classList.remove("hidden"),n.textContent=wp.i18n.__("Error while saving the changes."),wp.a11y.speak(wp.i18n.__("Error while saving the changes."))}))}(n,e),document.getElementById("bulk-action-selector-top").value="-1",document.getElementById("bulk-action-selector-bottom").value="-1",setTimeout((function(){a.style.display="",n.style.display="none",document.body.append(n)}),100)}))),document.querySelector(".inline-edit-wrapper").setAttribute("tabindex","-1"),document.querySelector(".inline-edit-wrapper").focus(),(p=document.querySelector(".inline-edit-save .cancel")).addEventListener("click",(function(){null!=m&&m.remove(),a.style.display="",document.getElementById("bulk-action-selector-top").value="-1",document.getElementById("bulk-action-selector-bottom").value="-1",o.style.display="none",document.body.append(o),n.style.display="none",document.body.append(n)})),n.addEventListener("keydown",(function(e){"Escape"===e.key&&p.click()})),o.addEventListener("keydown",(function(e){"Escape"===e.key&&p.click()})))}))})),document.querySelectorAll(".find-box-inside tr").forEach((function(e){e.addEventListener("click",(function(){e.querySelector(".found-radio input").checked=!0}))})),document.querySelectorAll(".copy-attachment-url.media-library").forEach((function(e){e.addEventListener("click",(function(){var t=e.getAttribute("data-clipboard-text"),o=document.createElement("input");navigator.clipboard?navigator.clipboard.writeText(t):(document.body.append(o),o.value=t,o.select(),document.execCommand("copy")),clearTimeout(n),e.nextElementSibling.classList.remove("hidden"),o.remove(),n=setTimeout((function(){e.nextElementSibling.classList.add("hidden")}),3e3),wp.a11y.speak(wp.i18n.__("The file URL has been copied to your clipboard"))}))}));document.body.className.includes("upload-php")&&null==o&&null!=i&&(i.addEventListener("change",(function(e){var t,n=document.querySelector(".is-dismissible"),o=new URLSearchParams({action:"media-cat-upload",option:"media_cat_upload_folder",media_cat_upload_value:e.target.value,media_cat_upload_nonce:document.getElementById("media_cat_upload_nonce").value});null!=n&&n.remove(),fetch(ajaxurl,{method:"POST",body:o,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(n){n.success&&(""==n.data.value?((t=document.createElement("div")).id="message",t.className="notice notice-error is-dismissible",t.innerHTML="<p>"+n.data.message+'</p><button class="notice-dismiss" type="button"></button>',document.querySelector(".page-title-action").after(t)):((t=document.createElement("div")).id="message",t.className="updated notice notice-success is-dismissible",t.innerHTML="<p>"+n.data.message+'</p><button class="notice-dismiss" type="button"></button>',document.querySelector(".page-title-action").after(t),i.childNodes.forEach((function(t){t.value===e.target.value?t.setAttribute("selected",!0):t.removeAttribute("selected")}))))}))["catch"]((function(e){(t=document.createElement("div")).id="message",t.className="notice notice-error is-dismissible",t.innerHTML="<p>"+e+'</p><button class="notice-dismiss" type="button"></button>',document.querySelector(".page-title-action").after(t)}))})),document.addEventListener("click",(function(e){"notice-dismiss"===e.target.className&&document.querySelector(".is-dismissible").remove()})))}));