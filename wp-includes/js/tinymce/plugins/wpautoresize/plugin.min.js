tinymce.PluginManager.add("wpautoresize",function(f){var y=f.settings,p=300,_=!1;function w(e){return parseInt(e,10)||0}function z(e){var t,o,n,i,a,s,u,r,l,d,g,m,h=tinymce.DOM;_&&(o=f.getDoc())&&(e=e||{},n=o.body,i=o.documentElement,a=y.autoresize_min_height,!n||e&&"setcontent"===e.type&&e.initial||function c(){return f.plugins.fullscreen&&f.plugins.fullscreen.isFullscreen()}()?n&&i&&(n.style.overflowY="auto",i.style.overflowY="auto"):(u=f.dom.getStyle(n,"margin-top",!0),r=f.dom.getStyle(n,"margin-bottom",!0),l=f.dom.getStyle(n,"padding-top",!0),d=f.dom.getStyle(n,"padding-bottom",!0),g=f.dom.getStyle(n,"border-top-width",!0),m=f.dom.getStyle(n,"border-bottom-width",!0),(s=n.offsetHeight+w(u)+w(r)+w(l)+w(d)+w(g)+w(m))&&s<i.offsetHeight&&(s=i.offsetHeight),(isNaN(s)||s<=0)&&(s=tinymce.Env.ie?n.scrollHeight:tinymce.Env.webkit&&0===n.clientHeight?0:n.offsetHeight),s>y.autoresize_min_height&&(a=s),y.autoresize_max_height&&s>y.autoresize_max_height?(a=y.autoresize_max_height,n.style.overflowY="auto",i.style.overflowY="auto"):(n.style.overflowY="hidden",i.style.overflowY="hidden",n.scrollTop=0),a!==p&&(t=a-p,h.setStyle(f.iframeElement,"height",a+"px"),p=a,tinymce.isWebKit&&t<0&&z(e),f.fire("wp-autoresize",{height:a,deltaHeight:"nodechange"===e.type?t:null}))))}function n(e,t,o){setTimeout(function(){z(),e--?n(e,t,o):o&&o()},t)}f.settings.inline||tinymce.Env.iOS||(y.autoresize_min_height=parseInt(f.getParam("autoresize_min_height",f.getElement().offsetHeight),10),y.autoresize_max_height=parseInt(f.getParam("autoresize_max_height",0),10),y.wp_autoresize_on&&(_=!0,f.on("init",function(){f.dom.addClass(f.getBody(),"wp-autoresize")}),f.on("nodechange keyup FullscreenStateChanged",z),f.on("setcontent",function(){n(3,100)}),f.getParam("autoresize_on_init",!0)&&f.on("init",function(){n(10,200,function(){n(5,1e3)})})),f.on("show",function(){p=0}),f.addCommand("wpAutoResize",z),f.addCommand("wpAutoResizeOn",function e(){f.dom.hasClass(f.getBody(),"wp-autoresize")||(_=!0,f.dom.addClass(f.getBody(),"wp-autoresize"),f.on("nodechange setcontent keyup FullscreenStateChanged",z),z())}),f.addCommand("wpAutoResizeOff",function t(){var e;y.wp_autoresize_on||(_=!1,e=f.getDoc(),f.dom.removeClass(f.getBody(),"wp-autoresize"),f.off("nodechange setcontent keyup FullscreenStateChanged",z),e.body.style.overflowY="auto",e.documentElement.style.overflowY="auto",p=0)}))});