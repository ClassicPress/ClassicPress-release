document.addEventListener("DOMContentLoaded",(function(){var e,t,{FilePond:a}=window,i=new URLSearchParams(window.location.search),n=document.querySelector(".page-title-action"),d=document.querySelector(".uploader-inline"),r=document.querySelector(".close"),o=document.getElementById("upload-category"),l=document.getElementById("filepond"),c=document.getElementById("ajax-url").value,s=(document.body,document.getElementById("media-modal")),u=document.getElementById("left-dashicon"),m=document.getElementById("right-dashicon"),p=document.getElementById("dialog-close-button"),g="1",y=document.getElementById("filter-by-date")?document.getElementById("filter-by-date"):"",v=document.getElementById("filter-by-type")?document.getElementById("filter-by-type"):"",h=document.getElementById("media-search-input"),b=document.getElementById("taxonomy=media_category&term")?document.getElementById("taxonomy=media_category&term"):"",f=document.querySelector("#media-grid ul");function S(e){var a=new URLSearchParams({action:"delete-post",_ajax_nonce:document.getElementById("media-"+e).dataset.deleteNonce,id:e});fetch(c,{method:"POST",body:a,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(a){1===a?(t=null!=document.getElementById("media-"+e).previousElementSibling?document.getElementById("media-"+e).previousElementSibling.id:null!=document.getElementById("media-"+e).nextElementSibling?document.getElementById("media-"+e).nextElementSibling.id:n.id,document.getElementById("media-"+e).remove(),p.click()):console.log(_wpMediaGridSettings.delete_failed)}))["catch"]((function(e){console.error(_wpMediaGridSettings.error,e)}))}function E(e){var t=e.id.replace("media-",""),a=e.getAttribute("aria-label"),n=e.dataset.date,d=e.dataset.filename,r=e.dataset.filetype,o=e.dataset.mime,l=e.dataset.size,p=e.dataset.width,g=e.dataset.height,y=e.dataset.caption,v=e.dataset.description,h=e.dataset.taxes,b=e.dataset.tags,f=e.dataset.url,E=e.querySelector("img").getAttribute("alt"),A=e.dataset.link,q=e.dataset.orientation?" "+e.dataset.orientation:"",_=e.dataset.menuOrder,w=e.previousElementSibling?e.previousElementSibling.id:"",x=e.nextElementSibling?e.nextElementSibling.id:"";i.set("item",t),history.replaceState(null,null,"?"+i.toString()),function(e){var t=document.createElement("form");t.className="compat-item",t.innerHTML='<input type="hidden" id="menu-order" name="attachments['+e+'][menu_order]" value="0"><p class="media-types media-types-required-info"><span class="required-field-message">Required fields are marked <span class="required">*</span></span></p><span class="setting" data-setting="media_category"><label for="attachments-'+e+'-media_category"><span class="alignleft">Media Categories</span></label><input type="text" class="text" id="attachments-'+e+'-media_category" name="attachments['+e+'][media_category]" value=""></span><span class="setting" data-setting="media_post_tag"><label for="attachments-'+e+'-media_post_tag"><span class="alignleft">Media Tags</span></label><input type="text" class="text" id="attachments-'+e+'-media_post_tag" name="attachments['+e+'][media_post_tag]" value=""></span>',null!=document.querySelector(".compat-item")&&document.querySelector(".compat-item").remove(),document.querySelector(".attachment-compat").append(t)}(t),s.querySelector(".attachment-date").textContent=n,s.querySelector(".attachment-filename").textContent=d,s.querySelector(".attachment-filetype").textContent=o,s.querySelector(".attachment-filesize").textContent=l,s.querySelector(".attachment-dimensions").textContent=p+" "+_wpMediaGridSettings.by+" "+g+" "+_wpMediaGridSettings.pixels,s.querySelector(".attachment-media-view").className="attachment-media-view"+q,s.querySelector("#attachment-details-two-column-alt-text").value=E,s.querySelector("#attachment-details-two-column-title").value=a,s.querySelector("#attachment-details-two-column-caption").value=y,s.querySelector("#attachment-details-two-column-description").value=v,s.querySelector("#attachment-details-two-column-copy-link").value=f,s.querySelector("#menu-order").value=_,s.querySelector("#attachments-"+t+"-media_category").value=h,s.querySelector("#attachments-"+t+"-media_post_tag").value=b,"audio"===r?(s.querySelector("#media-image").setAttribute("hidden",!0),s.querySelector("#media-video").setAttribute("hidden",!0),s.querySelector("#media-audio").removeAttribute("hidden"),s.querySelector("audio.wp-audio-shortcode").src=f,s.querySelector("audio").setAttribute("type",o)):"video"===r?(s.querySelector(".wp-video").removeAttribute("style"),s.querySelector("#media-image").setAttribute("hidden",!0),s.querySelector("#media-audio").setAttribute("hidden",!0),s.querySelector("#media-video").removeAttribute("hidden"),s.querySelector("video.wp-video-shortcode").src=f,s.querySelector("video").setAttribute("type",o)):(s.querySelector("#media-audio").setAttribute("hidden",!0),s.querySelector("#media-video").setAttribute("hidden",!0),s.querySelector("#media-image").removeAttribute("hidden"),"image"===r?(s.querySelector(".thumbnail-image img").src=f,s.querySelector(".edit-attachment").style.display=""):(s.querySelector(".thumbnail-image img").src=e.querySelector("img").src,s.querySelector(".edit-attachment").style.display="none")),s.querySelector(".thumbnail-image img").setAttribute("alt",E),s.querySelector("#view-attachment").href=A,s.querySelector("#edit-more").href=c.replace("admin-ajax.php","post.php?post="+t+"&action=edit"),s.querySelector("#download-file").href=f,u.setAttribute("data-prev",w),m.setAttribute("data-next",x),u.disabled=""===w,m.disabled=""===x,s.classList.add("modal-loading"),s.showModal(),s.querySelector(".delete-attachment").addEventListener("click",(function(){confirm(_wpMediaGridSettings.confirm_delete)&&S(t)})),s.querySelectorAll(".compat-item input").forEach((function(e){e.addEventListener("blur",(function(){!function(e,t){var a,i,n=new FormData,d=e.getAttribute("name").replace("attachments["+t+"][","").replace("]","");n.append("action","save-attachment-compat"),n.append("nonce",document.getElementById("media-"+t).dataset.updateNonce),n.append("id",t),n.append("taxonomy",d),n.append("attachments["+t+"]["+d+"]",e.value),fetch(c,{method:"POST",body:n,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(n){n.success?("media_category"===d?(i=n.data.media_cats.join(", "),e.value=i,document.getElementById("media-"+t).setAttribute("data-taxes",i)):"media_post_tag"===d&&(i=n.data.media_tags.join(", "),e.value=i,document.getElementById("media-"+t).setAttribute("data-tags",i)),clearTimeout(a),document.getElementById("tax-saved").classList.remove("hidden"),document.getElementById("tax-saved").setAttribute("aria-hidden","false"),a=setTimeout((function(){document.getElementById("tax-saved").classList.add("hidden"),document.getElementById("tax-saved").setAttribute("aria-hidden","true")}),3e3)):console.error(_wpMediaGridSettings.failed_update,n.data.error)}))["catch"]((function(e){console.error(_wpMediaGridSettings.error,e)}))}(e,t)}))}))}function A(e){var t=document.querySelector(".delete-selected-button");e.className.includes("selected")?(e.classList.remove("selected"),e.setAttribute("aria-checked",!1),null==document.querySelector(".media-item.selected")&&t.setAttribute("disabled",!0)):(e.classList.add("selected"),e.setAttribute("aria-checked",!0),t.disabled&&t.removeAttribute("disabled"))}function q(e){var t=document.createElement("li"),a='<img src="'+e.url+'" alt="'+e.alt+'">';return"application"===e.type?a="vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.subtype?'<div class="icon"><div class="centered"><img src="'+_wpMediaGridSettings.includes_url+'images/media/spreadsheet.png" draggable="false" alt=""></div><div class="filename"><div>'+e.title+"</div></div></div>":"zip"===e.subtype?'<div class="icon"><div class="centered"><img src="'+_wpMediaGridSettings.includes_url+'images/media/archive.png" draggable="false" alt=""></div><div class="filename"><div>'+e.title+"</div></div></div>":'<div class="icon"><div class="centered"><img src="'+_wpMediaGridSettings.includes_url+'images/media/document.png" draggable="false" alt=""></div><div class="filename"><div>'+e.title+"</div></div></div>":"audio"===e.type?a='<div class="icon"><div class="centered"><img src="'+_wpMediaGridSettings.includes_url+'images/media/audio.png" draggable="false" alt=""></div><div class="filename"><div>'+e.title+"</div></div></div>":"video"===e.type&&(a='<div class="icon"><div class="centered"><img src="'+_wpMediaGridSettings.includes_url+'images/media/video.png" draggable="false" alt=""></div><div class="filename"><div>'+e.title+"</div></div></div>"),t.className="media-item",t.id="media-"+e.id,t.setAttribute("tabindex",0),t.setAttribute("role","checkbox"),t.setAttribute("aria-checked","false"),t.setAttribute("aria-label",e.title),t.setAttribute("data-date",e.dateFormatted),t.setAttribute("data-url",e.url),t.setAttribute("data-filename",e.filename),t.setAttribute("data-filetype",e.type),t.setAttribute("data-mime",e.mime),t.setAttribute("data-width",e.width),t.setAttribute("data-height",e.height),t.setAttribute("data-size",e.filesizeHumanReadable),t.setAttribute("data-caption",e.caption),t.setAttribute("data-description",e.description),t.setAttribute("data-link",e.link),t.setAttribute("data-orientation",e.orientation),t.setAttribute("data-menu-order",e.menuOrder),t.setAttribute("data-taxes",e.media_cats),t.setAttribute("data-tags",e.media_tags),t.setAttribute("data-update-nonce",e.nonces.update),t.setAttribute("data-delete-nonce",e.nonces["delete"]),t.setAttribute("data-edit-nonce",e.nonces.edit),t.innerHTML='<div class="select-attachment-preview type-'+e.type+" subtype-"+e.subtype+'"><div class="media-thumbnail">'+a+'</div></div><button type="button" class="check" tabindex="-1"><span class="media-modal-icon"></span><span class="screen-reader-text">'+_wpMediaGridSettings.deselect+"></span></button>",t}function _(){var e=y.value,t=v.value,a=document.querySelector(".load-more-count").textContent;const n=new URLSearchParams({action:"query-attachments","query[posts_per_page]":document.getElementById("media_grid_per_page").value,"query[monthnum]":e?parseInt(e.substr(4,2),10):0,"query[year]":e?parseInt(e.substr(0,4),10):0,"query[post_mime_type]":t||"","query[s]":h?h.value:"","query[paged]":g||"1","query[media_category_name]":b?b.value:"",_ajax_nonce:document.getElementById("media_grid_nonce").value});fetch(c,{method:"POST",body:n,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(e){e.success?(f.innerHTML="",0===e.data.length?(document.querySelectorAll(".pagination-links a").forEach((function(e){e.setAttribute("href",e.href.replace(e.href.split("?paged=")[1],1)),e.setAttribute("disabled",!0),e.setAttribute("inert",!0)})),document.getElementById("current-page-selector").setAttribute("value",1),document.querySelector(".total-pages").textContent=1,document.querySelector(".displaying-num").textContent=document.querySelector(".displaying-num").textContent.replace(/[0-9]+/,0),document.querySelector(".load-more-count").setAttribute("hidden",!0),document.querySelector(".no-media").removeAttribute("hidden"),i.set("paged",1),history.replaceState(null,null,"?"+i.toString())):(e.data.forEach((function(e){var t=q(e);f.appendChild(t)})),document.querySelectorAll(".pagination-links a").forEach((function(t){t.className.includes("first-page")||t.className.includes("prev-page")?"1"===g?(t.setAttribute("disabled",!0),t.setAttribute("inert",!0)):(t.removeAttribute("disabled"),t.removeAttribute("inert"),t.className.includes("prev-page")&&t.setAttribute("href",t.href.replace(t.href.split("?paged=")[1],parseInt(g)-1))):t.className.includes("next-page")?e.headers.max_pages===parseInt(g)?(t.setAttribute("href",t.href.replace(t.href.split("?paged=")[1],g)),t.setAttribute("disabled",!0),t.setAttribute("inert",!0)):(t.setAttribute("href",t.href.replace(t.href.split("?paged=")[1],parseInt(g)+1)),t.removeAttribute("disabled"),t.removeAttribute("inert")):t.className.includes("last-page")&&(t.setAttribute("href",t.href.replace(t.href.split("?paged=")[1],e.headers.max_pages)),e.headers.max_pages===parseInt(g)?(t.setAttribute("disabled",!0),t.setAttribute("inert",!0)):(t.removeAttribute("disabled"),t.removeAttribute("inert"))),document.getElementById("current-page-selector").setAttribute("value",g||1),document.getElementById("current-page-selector").value=g||1,document.querySelector(".total-pages").textContent=e.headers.max_pages,document.querySelector(".displaying-num").textContent=document.querySelector(".displaying-num").textContent.replace(/[0-9]+/,e.headers.total_posts),i.set("paged",g),history.replaceState(null,null,"?"+i.toString())})),document.querySelectorAll(".media-item").forEach((function(e){e.addEventListener("click",(function(){null==document.querySelector(".media-toolbar-mode-select")?E(e):A(e)}))})),document.querySelector(".no-media").setAttribute("hidden",!0),document.querySelector(".load-more-count").removeAttribute("hidden"),document.querySelector(".load-more-count").textContent=a.replace(/[0-9]+/g,e.headers.total_posts).replace(/[0-9]+/,e.data.length)),g="1"):console.error(_wpMediaGridSettings.failed_update,e.data.message)}))["catch"]((function(e){console.error(_wpMediaGridSettings.error,e)}))}function w(){null!=document.querySelector(".imgedit-wrap")&&(document.querySelector(".imgedit-wrap").remove(),document.querySelector(".attachment-details").removeAttribute("hidden"),document.querySelector(".attachment-details").removeAttribute("inert"))}i.has("item")&&null!=(e=parseInt(i.get("item")))&&null!=document.getElementById("media-"+e)&&setTimeout((function(){document.getElementById("media-"+e).click(),i.has("mode")&&"edit"===i.get("mode")&&document.querySelector(".edit-attachment").click()})),null!=o&&(""==o.value&&(n.setAttribute("inert",!0),n.setAttribute("disabled",!0),window.addEventListener("dragover",(function(e){e.preventDefault()}),!1),window.addEventListener("drop",(function(e){e.preventDefault()}),!1)),o.addEventListener("change",(function(e){var t,a=document.querySelector(".is-dismissible"),i=new URLSearchParams({action:"media-cat-upload",option:"media_cat_upload_folder",media_cat_upload_value:e.target.value,media_cat_upload_nonce:document.getElementById("media_cat_upload_nonce").value});null!=a&&a.remove(),""==o.value?(n.setAttribute("inert",!0),n.setAttribute("disabled",!0),window.addEventListener("dragover",(function(e){e.preventDefault()}),!1),window.addEventListener("drop",(function(e){e.preventDefault()}),!1)):(n.removeAttribute("inert"),n.removeAttribute("disabled")),fetch(c,{method:"POST",body:i,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(a){a.success&&(""==a.data.value?((t=document.createElement("div")).id="message",t.className="notice notice-error is-dismissible",t.innerHTML="<p>"+a.data.message+'</p><button class="notice-dismiss" type="button"></button>',document.querySelector(".page-title-action").after(t)):((t=document.createElement("div")).id="message",t.className="updated notice notice-success is-dismissible",t.innerHTML="<p>"+a.data.message+'</p><button class="notice-dismiss" type="button"></button>',document.querySelector(".page-title-action").after(t),o.childNodes.forEach((function(t){t.value===e.target.value?t.setAttribute("selected",!0):t.removeAttribute("selected")}))))}))["catch"]((function(e){(t=document.createElement("div")).id="message",t.className="notice notice-error is-dismissible",t.innerHTML="<p>"+e+'</p><button class="notice-dismiss" type="button"></button>',document.querySelector(".page-title-action").after(t)}))})),document.addEventListener("click",(function(e){"notice-dismiss"===e.target.className&&document.querySelector(".is-dismissible").remove()}))),v&&v.addEventListener("change",_),y&&y.addEventListener("change",_),b&&b.addEventListener("change",_),h.addEventListener("input",(function(){var e;clearTimeout(e),e=setTimeout(_,200)})),document.getElementById("current-page-selector").addEventListener("change",(function(e){var t;g=e.target.value,clearTimeout(t),t=setTimeout(_,200)})),document.querySelectorAll(".pagination-links a").forEach((function(e){e.addEventListener("click",(function(t){""===v.value&&"0"===y.value&&"0"===b.value||(t.preventDefault(),g=e.href.split("?paged=")[1],_())}))})),n.addEventListener("click",(function(){d.hasAttribute("hidden")?(d.removeAttribute("inert"),d.removeAttribute("hidden"),n.setAttribute("aria-expanded",!0)):(d.setAttribute("inert",!0),d.setAttribute("hidden",!0),n.setAttribute("aria-expanded",!1))})),r.addEventListener("click",(function(){d.setAttribute("inert",!0),d.setAttribute("hidden",!0),n.setAttribute("aria-expanded",!1)})),document.addEventListener("keyup",(function(e){"Escape"===e.key?(i["delete"]("item"),i["delete"]("mode"),history.replaceState(null,null,location.href.split("?")[0]),r.click(),null!=t&&(document.getElementById(t).focus(),t=null),w()):"Enter"===e.key&&"media-item"===e.target.className&&e.target.click()})),document.querySelectorAll(".media-item").forEach((function(e){e.addEventListener("click",(function(){null==document.querySelector(".media-toolbar-mode-select")?E(e):A(e)}))})),p.addEventListener("click",(function(){i["delete"]("item"),i["delete"]("mode"),history.replaceState(null,null,location.href.split("?")[0]),s.classList.remove("modal-loading"),s.close(),null!=t&&(document.getElementById(t).focus(),t=null),w()})),s.querySelectorAll(".settings input, .settings textarea").forEach((function(e){e.addEventListener("blur",(function(){var t=i.get("item");!function(e,t){var a,i=new FormData;i.append("action","save-attachment"),i.append("id",t),i.append("nonce",document.getElementById("media-"+t).dataset.updateNonce),"alt"===e.parentNode.dataset.setting?i.append("changes[alt]",e.value):"title"===e.parentNode.dataset.setting?i.append("changes[title]",e.value):"caption"===e.parentNode.dataset.setting?i.append("changes[caption]",e.value):"description"===e.parentNode.dataset.setting&&i.append("changes[description]",e.value),fetch(c,{method:"POST",body:i,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(i){i.success?("alt"===e.parentNode.dataset.setting?document.getElementById("media-"+t).querySelector("img").setAttribute("alt",e.value):"title"===e.parentNode.dataset.setting?document.getElementById("media-"+t).setAttribute("aria-label",e.value):"caption"===e.parentNode.dataset.setting?document.getElementById("media-"+t).setAttribute("data-caption",e.value):"description"===e.parentNode.dataset.setting&&document.getElementById("media-"+t).setAttribute("data-description",e.value),clearTimeout(a),document.getElementById("details-saved").classList.remove("hidden"),document.getElementById("details-saved").setAttribute("aria-hidden","false"),a=setTimeout((function(){document.getElementById("details-saved").classList.add("hidden"),document.getElementById("details-saved").setAttribute("aria-hidden","true")}),3e3)):console.error(_wpMediaGridSettings.failed_update,i.data.error)}))["catch"]((function(e){console.error(_wpMediaGridSettings.error,e)}))}(e,t)}))})),u.addEventListener("click",(function(){var e=u.dataset.prev;t=e,document.getElementById(e).click(),w()})),m.addEventListener("click",(function(){var e=m.dataset.next;t=e,document.getElementById(e).click(),w()})),document.querySelector(".edit-attachment").addEventListener("click",(function(e){var t=parseInt(i.get("item")),a=document.getElementById("media-"+t),n=(a.dataset.width,a.dataset.height,a.dataset.editNonce),d=new FormData;d.append("action","image-editor"),d.append("_ajax_nonce",n),d.append("postid",t),d.append("do","rotate-cw"),d.append("target","full"),d.append("context","edit-attachment"),fetch(c,{method:"POST",body:d,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(e){document.querySelector(".attachment-details").setAttribute("hidden",!0),document.querySelector(".attachment-details").setAttribute("inert",!0),document.querySelector(".media-frame-content").insertAdjacentHTML("beforeend",e.data.html),i.set("mode","edit"),history.replaceState(null,null,"?"+i.toString())}))["catch"]((function(e){console.error("Error:",e)}))})),document.querySelector(".select-mode-toggle-button").addEventListener("click",(function(e){var t=document.querySelector(".cp-media-toolbar"),a=document.querySelector(".delete-selected-button");t.className.includes("media-toolbar-mode-select")?(document.querySelectorAll(".media-item").forEach((function(e){e.className.includes("selected")&&(e.classList.remove("selected"),e.setAttribute("aria-checked",!1))})),e.target.textContent="Bulk select",y.style.display="",v.style.display="",b.style.display="",a.classList.add("hidden"),t.classList.remove("media-toolbar-mode-select")):(e.target.textContent="Cancel",y.style.display="none",v.style.display="none",b.style.display="none",a.classList.remove("hidden"),t.classList.add("media-toolbar-mode-select"),a.addEventListener("click",(function(){confirm(_wpMediaGridSettings.confirm_multiple)&&document.querySelectorAll(".media-item.selected").forEach((function(e){S(e.id.replace("media-",""))})),document.querySelector(".select-mode-toggle-button").click()})))})),document.querySelector(".copy-attachment-url").addEventListener("click",(function(e){var t,a=e.target.parentNode.previousElementSibling.value,i=document.createElement("input");navigator.clipboard?navigator.clipboard.writeText(a):(document.body.append(i),i.value=a,i.select(),document.execCommand("copy")),clearTimeout(t),e.target.nextElementSibling.classList.remove("hidden"),e.target.nextElementSibling.setAttribute("aria-hidden","false"),i.remove(),t=setTimeout((function(){e.target.nextElementSibling.classList.add("hidden"),e.target.nextElementSibling.setAttribute("aria-hidden","true")}),3e3)})),a.registerPlugin(FilePondPluginFileValidateSize,FilePondPluginFileValidateType,FilePondPluginFileRename,FilePondPluginImagePreview),a.create(l,{allowMultiple:!0,server:{process:function(e,t,a,i,n,d,r,o,l){var s=new FormData;return s.append("async-upload",t,t.name),s.append("action","upload-attachment"),s.append("_wpnonce",document.getElementById("_wpnonce").value),fetch(c,{method:"POST",body:s,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(e){var t;e.success?(i(e.data),t=q(e.data),f.prepend(t),t.addEventListener("click",(function(){null==document.querySelector(".media-toolbar-mode-select")?E(t):A(t)}))):n(_wpMediaGridSettings.upload_failed)}))["catch"]((function(e){n(_wpMediaGridSettings.upload_failed),console.error(_wpMediaGridSettings.error,e)})),{abort:function(){r()}}},maxFileSize:document.getElementById("filepond").dataset.maxFileSize},labelTapToUndo:_wpMediaGridSettings.tap_close,fileRenameFunction:e=>new Promise((function(t){t(window.prompt(_wpMediaGridSettings.new_filename,e.name))})),acceptedFileTypes:document.querySelector(".uploader-inline").dataset.allowedMimes.split(","),labelFileTypeNotAllowed:_wpMediaGridSettings.invalid_type,fileValidateTypeLabelExpectedTypes:_wpMediaGridSettings.check_types})}));