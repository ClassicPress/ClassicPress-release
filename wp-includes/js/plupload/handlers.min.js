var topWin=window.dialogArguments||opener||parent||top;function fileQueued(e){jQuery(".media-blank").remove();var a=jQuery("#media-items").children(),r=post_id||0;1==a.length&&a.removeClass("open").find(".slidetoggle").slideUp(200),jQuery('<div class="media-item">').attr("id","media-item-"+e.id).addClass("child-of-"+r).append('<div class="progress"><div class="percent">0%</div><div class="bar"></div></div>',jQuery('<div class="filename original">').text(" "+e.name)).appendTo(jQuery("#media-items")),jQuery("#insert-gallery").prop("disabled",!0)}function uploadStart(){try{"undefined"!=typeof topWin.tb_remove&&topWin.jQuery("#TB_overlay").unbind("click",topWin.tb_remove)}catch(e){}return!0}function uploadProgress(e,a){var r=jQuery("#media-item-"+a.id);jQuery(".bar",r).width(200*a.loaded/a.size),jQuery(".percent",r).html(a.percent+"%")}function fileUploading(e,a){var r=104857600;parseInt(e.settings.max_file_size,10)>r&&a.size>r&&setTimeout((function(){a.status<3&&0===a.loaded&&(wpFileError(a,pluploadL10n.big_upload_failed.replace("%1$s",'<a class="uploader-html" href="#">').replace("%2$s","</a>")),e.stop(),e.removeFile(a),e.start())}),1e4)}function updateMediaForm(){var e=jQuery("#media-items").children();1==e.length?(e.addClass("open").find(".slidetoggle").show(),jQuery(".insert-gallery").hide()):e.length>1&&(e.removeClass("open"),jQuery(".insert-gallery").show()),e.not(".media-blank").length>0?jQuery(".savebutton").show():jQuery(".savebutton").hide()}function uploadSuccess(e,a){var r=jQuery("#media-item-"+e.id);"string"==typeof a&&(a=a.replace(/^<pre>(\d+)<\/pre>$/,"$1"),/media-upload-error|error-div/.test(a))?r.html(a):(r.find(".percent").html(pluploadL10n.crunching),prepareMediaItem(e,a),updateMediaForm(),post_id&&r.hasClass("child-of-"+post_id)&&jQuery("#attachments-count").text(1*jQuery("#attachments-count").text()+1))}function setResize(e){e?window.resize_width&&window.resize_height?uploader.settings.resize={enabled:!0,width:window.resize_width,height:window.resize_height,quality:100}:uploader.settings.multipart_params.image_resize=!0:delete uploader.settings.multipart_params.image_resize}function prepareMediaItem(e,a){var r="undefined"==typeof shortform?1:2,t=jQuery("#media-item-"+e.id);2==r&&shortform>2&&(r=shortform);try{"undefined"!=typeof topWin.tb_remove&&topWin.jQuery("#TB_overlay").click(topWin.tb_remove)}catch(i){}isNaN(a)||!a?(t.append(a),prepareMediaItemInit(e)):t.load("async-upload.php",{attachment_id:a,fetch:r},(function(){prepareMediaItemInit(e),updateMediaForm()}))}function prepareMediaItemInit(e){var a=jQuery("#media-item-"+e.id);jQuery(".thumbnail",a).clone().attr("class","pinkynail toggle").prependTo(a),jQuery(".filename.original",a).replaceWith(jQuery(".filename.new",a)),jQuery("a.delete",a).on("click",(function(){return jQuery.ajax({url:ajaxurl,type:"post",success:deleteSuccess,error:deleteError,id:e.id,data:{id:this.id.replace(/[^0-9]/g,""),action:"trash-post",_ajax_nonce:this.href.replace(/^.*wpnonce=/,"")}}),!1})),jQuery("a.undo",a).on("click",(function(){return jQuery.ajax({url:ajaxurl,type:"post",id:e.id,data:{id:this.id.replace(/[^0-9]/g,""),action:"untrash-post",_ajax_nonce:this.href.replace(/^.*wpnonce=/,"")},success:function(){var a,r=jQuery("#media-item-"+e.id);(a=jQuery("#type-of-"+e.id).val())&&jQuery("#"+a+"-counter").text(jQuery("#"+a+"-counter").text()-0+1),post_id&&r.hasClass("child-of-"+post_id)&&jQuery("#attachments-count").text(jQuery("#attachments-count").text()-0+1),jQuery(".filename .trashnotice",r).remove(),jQuery(".filename .title",r).css("font-weight","normal"),jQuery("a.undo",r).addClass("hidden"),jQuery(".menu_order_input",r).show(),r.css({backgroundColor:"#ceb"}).animate({backgroundColor:"#fff"},{queue:!1,duration:500,complete:function(){jQuery(this).css({backgroundColor:""})}}).removeClass("undo")}}),!1})),jQuery("#media-item-"+e.id+".startopen").removeClass("startopen").addClass("open").find("slidetoggle").fadeIn()}function wpQueueError(e){jQuery("#media-upload-error").show().html('<div class="error"><p>'+e+"</p></div>")}function wpFileError(e,a){itemAjaxError(e.id,a)}function itemAjaxError(e,a){var r=jQuery("#media-item-"+e),t=r.find(".filename").text();r.data("last-err")!=e&&r.html('<div class="error-div"><a class="dismiss" href="#">'+pluploadL10n.dismiss+"</a><strong>"+pluploadL10n.error_uploading.replace("%s",jQuery.trim(t))+"</strong> "+a+"</div>").data("last-err",e)}function deleteSuccess(e){var a,r,t;return"-1"==e?itemAjaxError(this.id,"You do not have permission. Has your session expired?"):"0"==e?itemAjaxError(this.id,"Could not be deleted. Has it been deleted already?"):(r=this.id,t=jQuery("#media-item-"+r),(a=jQuery("#type-of-"+r).val())&&jQuery("#"+a+"-counter").text(jQuery("#"+a+"-counter").text()-1),post_id&&t.hasClass("child-of-"+post_id)&&jQuery("#attachments-count").text(jQuery("#attachments-count").text()-1),1==jQuery("form.type-form #media-items").children().length&&jQuery(".hidden","#media-items").length>0&&(jQuery(".toggle").toggle(),jQuery(".slidetoggle").slideUp(200).siblings().removeClass("hidden")),jQuery(".toggle",t).toggle(),jQuery(".slidetoggle",t).slideUp(200).siblings().removeClass("hidden"),t.css({backgroundColor:"#faa"}).animate({backgroundColor:"#f4f4f4"},{queue:!1,duration:500}).addClass("undo"),jQuery(".filename:empty",t).remove(),jQuery(".filename .title",t).css("font-weight","bold"),jQuery(".filename",t).append('<span class="trashnotice"> '+pluploadL10n.deleted+" </span>").siblings("a.toggle").hide(),jQuery(".filename",t).append(jQuery("a.undo",t).removeClass("hidden")),void jQuery(".menu_order_input",t).hide())}function deleteError(){}function uploadComplete(){jQuery("#insert-gallery").prop("disabled",!1)}function switchUploader(e){e?(deleteUserSetting("uploader"),jQuery(".media-upload-form").removeClass("html-uploader"),"object"==typeof uploader&&uploader.refresh()):(setUserSetting("uploader","1"),jQuery(".media-upload-form").addClass("html-uploader"))}function uploadError(e,a,r,t){var i=104857600;switch(a){case plupload.FAILED:wpFileError(e,pluploadL10n.upload_failed);break;case plupload.FILE_EXTENSION_ERROR:wpFileExtensionError(t,e,pluploadL10n.invalid_filetype);break;case plupload.FILE_SIZE_ERROR:uploadSizeError(t,e);break;case plupload.IMAGE_FORMAT_ERROR:wpFileError(e,pluploadL10n.not_an_image);break;case plupload.IMAGE_MEMORY_ERROR:wpFileError(e,pluploadL10n.image_memory_exceeded);break;case plupload.IMAGE_DIMENSIONS_ERROR:wpFileError(e,pluploadL10n.image_dimensions_exceeded);break;case plupload.GENERIC_ERROR:wpQueueError(pluploadL10n.upload_failed);break;case plupload.IO_ERROR:parseInt(t.settings.filters.max_file_size,10)>i&&e.size>i?wpFileError(e,pluploadL10n.big_upload_failed.replace("%1$s",'<a class="uploader-html" href="#">').replace("%2$s","</a>")):wpQueueError(pluploadL10n.io_error);break;case plupload.HTTP_ERROR:wpQueueError(pluploadL10n.http_error);break;case plupload.INIT_ERROR:jQuery(".media-upload-form").addClass("html-uploader");break;case plupload.SECURITY_ERROR:wpQueueError(pluploadL10n.security_error);break;default:wpFileError(e,pluploadL10n.default_error)}}function uploadSizeError(e,a){var r,t;r=pluploadL10n.file_exceeds_size_limit.replace("%s",a.name),t=jQuery("<div />").attr({id:"media-item-"+a.id,"class":"media-item error"}).append(jQuery("<p />").text(r)),jQuery("#media-items").append(t),e.removeFile(a)}function wpFileExtensionError(e,a,r){jQuery("#media-items").append('<div id="media-item-'+a.id+'" class="media-item error"><p>'+r+"</p></div>"),e.removeFile(a)}function copyAttachmentUploadURLClipboard(){var e;new ClipboardJS(".copy-attachment-url").on("success",(function(a){var r=jQuery(a.trigger),t=jQuery(".success",r.closest(".copy-to-clipboard-container"));a.clearSelection(),r.trigger("focus"),clearTimeout(e),t.removeClass("hidden"),e=setTimeout((function(){t.addClass("hidden")}),3e3),wp.a11y.speak(pluploadL10n.file_url_copied)}))}jQuery(document).ready((function(e){copyAttachmentUploadURLClipboard();var a,r={};e(".media-upload-form").on("click.uploader",(function(a){var r,t,i=e(a.target);i.is('input[type="radio"]')?(r=i.closest("tr")).hasClass("align")?setUserSetting("align",i.val()):r.hasClass("image-size")&&setUserSetting("imgsize",i.val()):i.is("button.button")?(t=(t=a.target.className||"").match(/url([^ '"]+)/))&&t[1]&&(setUserSetting("urlbutton",t[1]),i.siblings(".urlfield").val(i.data("link-url"))):i.is("a.dismiss")?i.parents(".media-item").fadeOut(200,(function(){e(this).remove()})):i.is(".upload-flash-bypass a")||i.is("a.uploader-html")?(e("#media-items, p.submit, span.big-file-warning").css("display","none"),switchUploader(0),a.preventDefault()):i.is(".upload-html-bypass a")?(e("#media-items, p.submit, span.big-file-warning").css("display",""),switchUploader(1),a.preventDefault()):i.is("a.describe-toggle-on")?(i.parent().addClass("open"),i.siblings(".slidetoggle").fadeIn(250,(function(){var a,r,t=e(window).scrollTop(),i=e(window).height(),o=e(this).offset().top,d=e(this).height();i&&o&&d&&(a=o+d)>(r=t+i)&&(a-r<o-t?window.scrollBy(0,a-r+10):window.scrollBy(0,o-t-40))})),a.preventDefault()):i.is("a.describe-toggle-off")&&(i.siblings(".slidetoggle").fadeOut(250,(function(){i.parent().removeClass("open")})),a.preventDefault())})),a=function(t,i){var o,d,l=i.file;if(i&&i.responseHeaders)if((d=i.responseHeaders.match(/x-wp-upload-attachment-id:\s*(\d+)/i))&&d[1]){if(d=d[1],(o=r[l.id])&&o>4)return e.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"media-create-image-subsizes",_wpnonce:wpUploaderInit.multipart_params._wpnonce,attachment_id:d,_wp_upload_failed_cleanup:!0}}),void(i.message&&(i.status<500||i.status>=600)?wpQueueError(i.message):wpQueueError(pluploadL10n.http_error_image));r[l.id]=o?++o:1,e.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"media-create-image-subsizes",_wpnonce:wpUploaderInit.multipart_params._wpnonce,attachment_id:d,_legacy_support:"true"}}).done((function(e){var a;e.success?uploadSuccess(l,e.data.id):(e.data&&e.data.message&&(a=e.data.message),wpQueueError(a||pluploadL10n.http_error_image))})).fail((function(e){e.status>=500&&e.status<600?a(t,i):wpQueueError(pluploadL10n.http_error_image)}))}else wpQueueError(pluploadL10n.http_error_image);else wpQueueError(pluploadL10n.http_error_image)},uploader_init=function(){uploader=new plupload.Uploader(wpUploaderInit),e("#image_resize").on("change",(function(){var a=e(this).prop("checked");setResize(a),a?setUserSetting("upload_resize","1"):deleteUserSetting("upload_resize")})),uploader.bind("Init",(function(a){var r=e("#plupload-upload-ui");setResize(getUserSetting("upload_resize",!1)),a.features.dragdrop&&!e(document.body).hasClass("mobile")?(r.addClass("drag-drop"),e("#drag-drop-area").on("dragover.wp-uploader",(function(){r.addClass("drag-over")})).on("dragleave.wp-uploader, drop.wp-uploader",(function(){r.removeClass("drag-over")}))):(r.removeClass("drag-drop"),e("#drag-drop-area").off(".wp-uploader")),"html4"===a.runtime&&e(".upload-flash-bypass").hide()})),uploader.bind("postinit",(function(e){e.refresh()})),uploader.init(),uploader.bind("FilesAdded",(function(a,r){e("#media-upload-error").empty(),uploadStart(),plupload.each(r,(function(e){if("image/heic"===e.type&&a.settings.heic_upload_error)wpQueueError(pluploadL10n.unsupported_image);else if("image/webp"===e.type&&a.settings.webp_upload_error)return wpQueueError(pluploadL10n.noneditable_image),void a.removeFile(e);fileQueued(e)})),a.refresh(),a.start()})),uploader.bind("UploadFile",(function(e,a){fileUploading(e,a)})),uploader.bind("UploadProgress",(function(e,a){uploadProgress(e,a)})),uploader.bind("Error",(function(e,r){var t=r.file&&r.file.type&&0===r.file.type.indexOf("image/"),i=r&&r.status;t&&i>=500&&i<600?a(e,r):(uploadError(r.file,r.code,r.message,e),e.refresh())})),uploader.bind("FileUploaded",(function(e,a,r){uploadSuccess(a,r.response)})),uploader.bind("UploadComplete",(function(){uploadComplete()}))},"object"==typeof wpUploaderInit&&uploader_init()}));var uploader,uploader_init;topWin=window.dialogArguments||opener||parent||top;function fileQueued(e){jQuery(".media-blank").remove();var a=jQuery("#media-items").children(),r=post_id||0;1==a.length&&a.removeClass("open").find(".slidetoggle").slideUp(200),jQuery('<div class="media-item">').attr("id","media-item-"+e.id).addClass("child-of-"+r).append('<div class="progress"><div class="percent">0%</div><div class="bar"></div></div>',jQuery('<div class="filename original">').text(" "+e.name)).appendTo(jQuery("#media-items")),jQuery("#insert-gallery").prop("disabled",!0)}function uploadStart(){try{void 0!==topWin.tb_remove&&topWin.jQuery("#TB_overlay").unbind("click",topWin.tb_remove)}catch(e){}return!0}function uploadProgress(e,a){var r=jQuery("#media-item-"+a.id);jQuery(".bar",r).width(200*a.loaded/a.size),jQuery(".percent",r).html(a.percent+"%")}function fileUploading(e,a){var r=104857600;r<parseInt(e.settings.max_file_size,10)&&a.size>r&&setTimeout((function(){a.status<3&&0===a.loaded&&(wpFileError(a,pluploadL10n.big_upload_failed.replace("%1$s",'<a class="uploader-html" href="#">').replace("%2$s","</a>")),e.stop(),e.removeFile(a),e.start())}),1e4)}function updateMediaForm(){var e=jQuery("#media-items").children();1==e.length?(e.addClass("open").find(".slidetoggle").show(),jQuery(".insert-gallery").hide()):1<e.length&&(e.removeClass("open"),jQuery(".insert-gallery").show()),0<e.not(".media-blank").length?jQuery(".savebutton").show():jQuery(".savebutton").hide()}function uploadSuccess(e,a){var r=jQuery("#media-item-"+e.id);"string"==typeof a&&(a=a.replace(/^<pre>(\d+)<\/pre>$/,"$1"),/media-upload-error|error-div/.test(a))?r.html(a):(r.find(".percent").html(pluploadL10n.crunching),prepareMediaItem(e,a),updateMediaForm(),post_id&&r.hasClass("child-of-"+post_id)&&jQuery("#attachments-count").text(+jQuery("#attachments-count").text()+1))}function setResize(e){e?window.resize_width&&window.resize_height?uploader.settings.resize={enabled:!0,width:window.resize_width,height:window.resize_height,quality:100}:uploader.settings.multipart_params.image_resize=!0:delete uploader.settings.multipart_params.image_resize}function prepareMediaItem(e,a){var r="undefined"==typeof shortform?1:2,t=jQuery("#media-item-"+e.id);2==r&&2<shortform&&(r=shortform);try{void 0!==topWin.tb_remove&&topWin.jQuery("#TB_overlay").click(topWin.tb_remove)}catch(e){}isNaN(a)||!a?(t.append(a),prepareMediaItemInit(e)):t.load("async-upload.php",{attachment_id:a,fetch:r},(function(){prepareMediaItemInit(e),updateMediaForm()}))}function prepareMediaItemInit(e){var a=jQuery("#media-item-"+e.id);jQuery(".thumbnail",a).clone().attr("class","pinkynail toggle").prependTo(a),jQuery(".filename.original",a).replaceWith(jQuery(".filename.new",a)),jQuery("a.delete",a).on("click",(function(){return jQuery.ajax({url:ajaxurl,type:"post",success:deleteSuccess,error:deleteError,id:e.id,data:{id:this.id.replace(/[^0-9]/g,""),action:"trash-post",_ajax_nonce:this.href.replace(/^.*wpnonce=/,"")}}),!1})),jQuery("a.undo",a).on("click",(function(){return jQuery.ajax({url:ajaxurl,type:"post",id:e.id,data:{id:this.id.replace(/[^0-9]/g,""),action:"untrash-post",_ajax_nonce:this.href.replace(/^.*wpnonce=/,"")},success:function(){var a,r=jQuery("#media-item-"+e.id);(a=jQuery("#type-of-"+e.id).val())&&jQuery("#"+a+"-counter").text(+jQuery("#"+a+"-counter").text()+1),post_id&&r.hasClass("child-of-"+post_id)&&jQuery("#attachments-count").text(+jQuery("#attachments-count").text()+1),jQuery(".filename .trashnotice",r).remove(),jQuery(".filename .title",r).css("font-weight","normal"),jQuery("a.undo",r).addClass("hidden"),jQuery(".menu_order_input",r).show(),r.css({backgroundColor:"#ceb"}).animate({backgroundColor:"#fff"},{queue:!1,duration:500,complete:function(){jQuery(this).css({backgroundColor:""})}}).removeClass("undo")}}),!1})),jQuery("#media-item-"+e.id+".startopen").removeClass("startopen").addClass("open").find("slidetoggle").fadeIn()}function wpQueueError(e){jQuery("#media-upload-error").show().html('<div class="error"><p>'+e+"</p></div>")}function wpFileError(e,a){itemAjaxError(e.id,a)}function itemAjaxError(e,a){var r=jQuery("#media-item-"+e),t=r.find(".filename").text();r.data("last-err")!=e&&r.html('<div class="error-div"><a class="dismiss" href="#">'+pluploadL10n.dismiss+"</a><strong>"+pluploadL10n.error_uploading.replace("%s",jQuery.trim(t))+"</strong> "+a+"</div>").data("last-err",e)}function deleteSuccess(e){var a;return"-1"==e?itemAjaxError(this.id,"You do not have permission. Has your session expired?"):"0"==e?itemAjaxError(this.id,"Could not be deleted. Has it been deleted already?"):(e=this.id,a=jQuery("#media-item-"+e),(e=jQuery("#type-of-"+e).val())&&jQuery("#"+e+"-counter").text(jQuery("#"+e+"-counter").text()-1),post_id&&a.hasClass("child-of-"+post_id)&&jQuery("#attachments-count").text(jQuery("#attachments-count").text()-1),1==jQuery("form.type-form #media-items").children().length&&0<jQuery(".hidden","#media-items").length&&(jQuery(".toggle").toggle(),jQuery(".slidetoggle").slideUp(200).siblings().removeClass("hidden")),jQuery(".toggle",a).toggle(),jQuery(".slidetoggle",a).slideUp(200).siblings().removeClass("hidden"),a.css({backgroundColor:"#faa"}).animate({backgroundColor:"#f4f4f4"},{queue:!1,duration:500}).addClass("undo"),jQuery(".filename:empty",a).remove(),jQuery(".filename .title",a).css("font-weight","bold"),jQuery(".filename",a).append('<span class="trashnotice"> '+pluploadL10n.deleted+" </span>").siblings("a.toggle").hide(),jQuery(".filename",a).append(jQuery("a.undo",a).removeClass("hidden")),void jQuery(".menu_order_input",a).hide())}function deleteError(){}function uploadComplete(){jQuery("#insert-gallery").prop("disabled",!1)}function switchUploader(e){e?(deleteUserSetting("uploader"),jQuery(".media-upload-form").removeClass("html-uploader"),"object"==typeof uploader&&uploader.refresh()):(setUserSetting("uploader","1"),jQuery(".media-upload-form").addClass("html-uploader"))}function uploadError(e,a,r,t){var i=104857600;switch(a){case plupload.FAILED:wpFileError(e,pluploadL10n.upload_failed);break;case plupload.FILE_EXTENSION_ERROR:wpFileExtensionError(t,e,pluploadL10n.invalid_filetype);break;case plupload.FILE_SIZE_ERROR:uploadSizeError(t,e);break;case plupload.IMAGE_FORMAT_ERROR:wpFileError(e,pluploadL10n.not_an_image);break;case plupload.IMAGE_MEMORY_ERROR:wpFileError(e,pluploadL10n.image_memory_exceeded);break;case plupload.IMAGE_DIMENSIONS_ERROR:wpFileError(e,pluploadL10n.image_dimensions_exceeded);break;case plupload.GENERIC_ERROR:wpQueueError(pluploadL10n.upload_failed);break;case plupload.IO_ERROR:i<parseInt(t.settings.filters.max_file_size,10)&&e.size>i?wpFileError(e,pluploadL10n.big_upload_failed.replace("%1$s",'<a class="uploader-html" href="#">').replace("%2$s","</a>")):wpQueueError(pluploadL10n.io_error);break;case plupload.HTTP_ERROR:wpQueueError(pluploadL10n.http_error);break;case plupload.INIT_ERROR:jQuery(".media-upload-form").addClass("html-uploader");break;case plupload.SECURITY_ERROR:wpQueueError(pluploadL10n.security_error);break;default:wpFileError(e,pluploadL10n.default_error)}}function uploadSizeError(e,a){var r=pluploadL10n.file_exceeds_size_limit.replace("%s",a.name);r=jQuery("<div />").attr({id:"media-item-"+a.id,"class":"media-item error"}).append(jQuery("<p />").text(r));jQuery("#media-items").append(r),e.removeFile(a)}function wpFileExtensionError(e,a,r){jQuery("#media-items").append('<div id="media-item-'+a.id+'" class="media-item error"><p>'+r+"</p></div>"),e.removeFile(a)}function copyAttachmentUploadURLClipboard(){var e;new ClipboardJS(".copy-attachment-url").on("success",(function(a){var r=jQuery(a.trigger),t=jQuery(".success",r.closest(".copy-to-clipboard-container"));a.clearSelection(),r.trigger("focus"),clearTimeout(e),t.removeClass("hidden"),e=setTimeout((function(){t.addClass("hidden")}),3e3),wp.a11y.speak(pluploadL10n.file_url_copied)}))}jQuery(document).ready((function(e){copyAttachmentUploadURLClipboard();var a,r={};e(".media-upload-form").on("click.uploader",(function(a){var r,t=e(a.target);t.is('input[type="radio"]')?(r=t.closest("tr")).hasClass("align")?setUserSetting("align",t.val()):r.hasClass("image-size")&&setUserSetting("imgsize",t.val()):t.is("button.button")?(r=(r=a.target.className||"").match(/url([^ '"]+)/))&&r[1]&&(setUserSetting("urlbutton",r[1]),t.siblings(".urlfield").val(t.data("link-url"))):t.is("a.dismiss")?t.parents(".media-item").fadeOut(200,(function(){e(this).remove()})):t.is(".upload-flash-bypass a")||t.is("a.uploader-html")?(e("#media-items, p.submit, span.big-file-warning").css("display","none"),switchUploader(0),a.preventDefault()):t.is(".upload-html-bypass a")?(e("#media-items, p.submit, span.big-file-warning").css("display",""),switchUploader(1),a.preventDefault()):t.is("a.describe-toggle-on")?(t.parent().addClass("open"),t.siblings(".slidetoggle").fadeIn(250,(function(){var a=e(window).scrollTop(),r=e(window).height(),t=e(this).offset().top,i=e(this).height();r&&t&&i&&(r=a+r)<(i=t+i)&&(i-r<t-a?window.scrollBy(0,i-r+10):window.scrollBy(0,t-a-40))})),a.preventDefault()):t.is("a.describe-toggle-off")&&(t.siblings(".slidetoggle").fadeOut(250,(function(){t.parent().removeClass("open")})),a.preventDefault())})),a=function(t,i){var o,d,l=i.file;i&&i.responseHeaders&&(d=i.responseHeaders.match(/x-wp-upload-attachment-id:\s*(\d+)/i))&&d[1]?(d=d[1],(o=r[l.id])&&4<o?(e.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"media-create-image-subsizes",_wpnonce:wpUploaderInit.multipart_params._wpnonce,attachment_id:d,_wp_upload_failed_cleanup:!0}}),i.message&&(i.status<500||600<=i.status)?wpQueueError(i.message):wpQueueError(pluploadL10n.http_error_image)):(r[l.id]=o?++o:1,e.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"media-create-image-subsizes",_wpnonce:wpUploaderInit.multipart_params._wpnonce,attachment_id:d,_legacy_support:"true"}}).done((function(e){var a;e.success?uploadSuccess(l,e.data.id):wpQueueError((a=e.data&&e.data.message?e.data.message:a)||pluploadL10n.http_error_image)})).fail((function(e){500<=e.status&&e.status<600?a(t,i):wpQueueError(pluploadL10n.http_error_image)})))):wpQueueError(pluploadL10n.http_error_image)},uploader_init=function(){uploader=new plupload.Uploader(wpUploaderInit),e("#image_resize").on("change",(function(){var a=e(this).prop("checked");setResize(a),a?setUserSetting("upload_resize","1"):deleteUserSetting("upload_resize")})),uploader.bind("Init",(function(a){var r=e("#plupload-upload-ui");setResize(getUserSetting("upload_resize",!1)),a.features.dragdrop&&!e(document.body).hasClass("mobile")?(r.addClass("drag-drop"),e("#drag-drop-area").on("dragover.wp-uploader",(function(){r.addClass("drag-over")})).on("dragleave.wp-uploader, drop.wp-uploader",(function(){r.removeClass("drag-over")}))):(r.removeClass("drag-drop"),e("#drag-drop-area").off(".wp-uploader")),"html4"===a.runtime&&e(".upload-flash-bypass").hide()})),uploader.bind("postinit",(function(e){e.refresh()})),uploader.init(),uploader.bind("FilesAdded",(function(a,r){e("#media-upload-error").empty(),uploadStart(),plupload.each(r,(function(e){if("image/heic"===e.type&&a.settings.heic_upload_error)wpQueueError(pluploadL10n.unsupported_image);else if("image/webp"===e.type&&a.settings.webp_upload_error)return wpQueueError(pluploadL10n.noneditable_image),void a.removeFile(e);fileQueued(e)})),a.refresh(),a.start()})),uploader.bind("UploadFile",(function(e,a){fileUploading(e,a)})),uploader.bind("UploadProgress",(function(e,a){uploadProgress(e,a)})),uploader.bind("Error",(function(e,r){var t=r.file&&r.file.type&&0===r.file.type.indexOf("image/"),i=r&&r.status;t&&500<=i&&i<600?a(e,r):(uploadError(r.file,r.code,r.message,e),e.refresh())})),uploader.bind("FileUploaded",(function(e,a,r){uploadSuccess(a,r.response)})),uploader.bind("UploadComplete",(function(){uploadComplete()}))},"object"==typeof wpUploaderInit&&uploader_init()}));