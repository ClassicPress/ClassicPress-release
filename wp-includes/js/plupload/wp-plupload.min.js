window.wp=window.wp||{},function(e,t){var r;"undefined"!=typeof _wpPluploadSettings&&(r=function(e){var a,o,i,n,p=this,d={container:"container",browser:"browse_button",dropzone:"drop_element"},s={};if(this.supports={upload:r.browser.supported},this.supported=this.supports.upload,this.supported){for(o in this.plupload=t.extend(!0,{multipart_params:{}},r.defaults),this.container=document.body,t.extend(!0,this,e),this)"function"==typeof this[o]&&(this[o]=t.proxy(this[o],this));for(o in d)this[o]&&(this[o]=t(this[o]).first(),this[o].length?(this[o].prop("id")||this[o].prop("id","__wp-uploader-id-"+r.uuid++),this.plupload[d[o]]=this[o].prop("id")):delete this[o]);(this.browser&&this.browser.length||this.dropzone&&this.dropzone.length)&&(this.uploader=new plupload.Uploader(this.plupload),delete this.plupload,this.param(this.params||{}),delete this.params,a=function(e,r,o){var d,u;if(r&&r.responseHeaders)if((u=r.responseHeaders.match(/x-wp-upload-attachment-id:\s*(\d+)/i))&&u[1]){if(u=u[1],(d=s[o.id])&&d>4)return t.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"media-create-image-subsizes",_wpnonce:_wpPluploadSettings.defaults.multipart_params._wpnonce,attachment_id:u,_wp_upload_failed_cleanup:!0}}),void i(e,r,o,"no-retry");s[o.id]=d?++d:1,t.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"media-create-image-subsizes",_wpnonce:_wpPluploadSettings.defaults.multipart_params._wpnonce,attachment_id:u}}).done((function(t){t.success?n(p.uploader,o,t):(t.data&&t.data.message&&(e=t.data.message),i(e,r,o,"no-retry"))})).fail((function(t){t.status>=500&&t.status<600?a(e,r,o):i(e,r,o,"no-retry")}))}else i(pluploadL10n.http_error_image,r,o,"no-retry");else i(pluploadL10n.http_error_image,r,o,"no-retry")},i=function(e,t,o,i){var n=o.type&&0===o.type.indexOf("image/"),d=t&&t.status;"no-retry"!==i&&n&&d>=500&&d<600?a(e,t,o):(o.attachment&&o.attachment.destroy(),r.errors.unshift({message:e||pluploadL10n.default_error,data:t,file:o}),p.error(e,t,o))},n=function(e,t,a){_.each(["file","loaded","size","percent"],(function(e){t.attachment.unset(e)})),t.attachment.set(_.extend(a.data,{uploading:!1})),wp.media.model.Attachment.get(a.data.id,t.attachment),r.queue.all((function(e){return!e.get("uploading")}))&&r.queue.reset(),p.success(t.attachment)},this.uploader.bind("init",(function(e){var a,o,i,n,d=p.dropzone;if(i=p.supports.dragdrop=e.features.dragdrop&&!r.browser.mobile,(n=new MutationObserver((function(){if(document.getElementById("menu-item-gallery-edit")||document.getElementById("menu-item-playlist-edit")||document.getElementById("menu-item-video-playlist-edit"))return n.disconnect(),d.unbind(".wp-uploader")}))).observe(document,{attributes:!1,childList:!0,subtree:!0}),d){if(d.toggleClass("supports-drag-drop",!!i),!i)return d.unbind(".wp-uploader");d.on("dragover.wp-uploader",(function(){a&&clearTimeout(a),o||(d.trigger("dropzone:enter").addClass("drag-over"),o=!0)})),d.on("dragleave.wp-uploader, drop.wp-uploader",(function(){a=setTimeout((function(){o=!1,d.trigger("dropzone:leave").removeClass("drag-over")}),0)})),p.ready=!0,t(p).trigger("uploader:ready")}})),this.uploader.bind("postinit",(function(e){e.refresh(),p.init()})),this.uploader.init(),this.browser?this.browser.on("mouseenter",this.refresh):this.uploader.disableBrowse(!0),t(p).on("uploader:ready",(function(){t('.moxie-shim-html5 input[type="file"]').attr({tabIndex:"-1","aria-hidden":"true"})})),this.uploader.bind("FilesAdded",(function(e,t){_.each(t,(function(t){var a,o;if(plupload.FAILED!==t.status){if("image/heic"===t.type&&e.settings.heic_upload_error)r.errors.unshift({message:pluploadL10n.unsupported_image,data:{},file:t});else if("image/webp"===t.type&&e.settings.webp_upload_error)return i(pluploadL10n.noneditable_image,{},t,"no-retry"),void e.removeFile(t);a=_.extend({file:t,uploading:!0,date:new Date,filename:t.name,menuOrder:0,uploadedTo:wp.media.model.settings.post.id},_.pick(t,"loaded","size","percent")),(o=/(?:jpe?g|png|gif)$/i.exec(t.name))&&(a.type="image",a.subtype="jpg"===o[0]?"jpeg":o[0]),t.attachment=wp.media.model.Attachment.create(a),r.queue.add(t.attachment),p.added(t.attachment)}})),e.refresh(),e.start()})),this.uploader.bind("UploadProgress",(function(e,t){t.attachment.set(_.pick(t,"loaded","percent")),p.progress(t.attachment)})),this.uploader.bind("FileUploaded",(function(e,t,r){try{r=JSON.parse(r.response)}catch(a){return i(pluploadL10n.default_error,a,t)}return!_.isObject(r)||_.isUndefined(r.success)?i(pluploadL10n.default_error,null,t):r.success?void n(e,t,r):i(r.data&&r.data.message,r.data,t)})),this.uploader.bind("Error",(function(e,t){var a,o=pluploadL10n.default_error;for(a in r.errorMap)if(t.code===plupload[a]){"function"==typeof(o=r.errorMap[a])&&(o=o(t.file,t));break}i(o,t,t.file),e.refresh()})))}},t.extend(r,_wpPluploadSettings),r.uuid=0,r.errorMap={FAILED:pluploadL10n.upload_failed,FILE_EXTENSION_ERROR:pluploadL10n.invalid_filetype,IMAGE_FORMAT_ERROR:pluploadL10n.not_an_image,IMAGE_MEMORY_ERROR:pluploadL10n.image_memory_exceeded,IMAGE_DIMENSIONS_ERROR:pluploadL10n.image_dimensions_exceeded,GENERIC_ERROR:pluploadL10n.upload_failed,IO_ERROR:pluploadL10n.io_error,SECURITY_ERROR:pluploadL10n.security_error,FILE_SIZE_ERROR:function(e){return pluploadL10n.file_exceeds_size_limit.replace("%s",e.name)},HTTP_ERROR:function(e){return e.type&&0===e.type.indexOf("image/")?pluploadL10n.http_error_image:pluploadL10n.http_error}},t.extend(r.prototype,{param:function(e,r){if(1===arguments.length&&"string"==typeof e)return this.uploader.settings.multipart_params[e];arguments.length>1?this.uploader.settings.multipart_params[e]=r:t.extend(this.uploader.settings.multipart_params,e)},init:function(){},error:function(){},success:function(){},added:function(){},progress:function(){},complete:function(){},refresh:function(){var e,r,a,o;if(this.browser){for(e=this.browser[0];e;){if(e===document.body){r=!0;break}e=e.parentNode}r||(o="wp-uploader-browser-"+this.uploader.id,(a=t("#"+o)).length||(a=t('<div class="wp-uploader-browser" />').css({position:"fixed",top:"-1000px",left:"-1000px",height:0,width:0}).attr("id","wp-uploader-browser-"+this.uploader.id).appendTo("body")),a.append(this.browser))}this.uploader.refresh()}}),r.queue=new wp.media.model.Attachments([],{query:!1}),r.errors=new Backbone.Collection,e.Uploader=r)}(wp,jQuery),window.wp=window.wp||{},function(e,t){var r;"undefined"!=typeof _wpPluploadSettings&&(t.extend(r=function(e){var a,o,i,n,p=this,d={container:"container",browser:"browse_button",dropzone:"drop_element"},s={};if(this.supports={upload:r.browser.supported},this.supported=this.supports.upload,this.supported){for(o in this.plupload=t.extend(!0,{multipart_params:{}},r.defaults),this.container=document.body,t.extend(!0,this,e),this)"function"==typeof this[o]&&(this[o]=t.proxy(this[o],this));for(o in d)this[o]&&(this[o]=t(this[o]).first(),this[o].length?(this[o].prop("id")||this[o].prop("id","__wp-uploader-id-"+r.uuid++),this.plupload[d[o]]=this[o].prop("id")):delete this[o]);(this.browser&&this.browser.length||this.dropzone&&this.dropzone.length)&&(this.uploader=new plupload.Uploader(this.plupload),delete this.plupload,this.param(this.params||{}),delete this.params,a=function(e,r,o){var d,u;r&&r.responseHeaders&&(u=r.responseHeaders.match(/x-wp-upload-attachment-id:\s*(\d+)/i))&&u[1]?(u=u[1],(d=s[o.id])&&4<d?(t.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"media-create-image-subsizes",_wpnonce:_wpPluploadSettings.defaults.multipart_params._wpnonce,attachment_id:u,_wp_upload_failed_cleanup:!0}}),i(e,r,o,"no-retry")):(s[o.id]=d?++d:1,t.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"media-create-image-subsizes",_wpnonce:_wpPluploadSettings.defaults.multipart_params._wpnonce,attachment_id:u}}).done((function(t){t.success?n(p.uploader,o,t):(t.data&&t.data.message&&(e=t.data.message),i(e,r,o,"no-retry"))})).fail((function(t){500<=t.status&&t.status<600?a(e,r,o):i(e,r,o,"no-retry")})))):i(pluploadL10n.http_error_image,r,o,"no-retry")},i=function(e,t,o,i){var n=o.type&&0===o.type.indexOf("image/"),d=t&&t.status;"no-retry"!==i&&n&&500<=d&&d<600?a(e,t,o):(o.attachment&&o.attachment.destroy(),r.errors.unshift({message:e||pluploadL10n.default_error,data:t,file:o}),p.error(e,t,o))},n=function(e,t,a){_.each(["file","loaded","size","percent"],(function(e){t.attachment.unset(e)})),t.attachment.set(_.extend(a.data,{uploading:!1})),wp.media.model.Attachment.get(a.data.id,t.attachment),r.queue.all((function(e){return!e.get("uploading")}))&&r.queue.reset(),p.success(t.attachment)},this.uploader.bind("init",(function(e){var a,o,i=p.dropzone;e=p.supports.dragdrop=e.features.dragdrop&&!r.browser.mobile;if(i){if(i.toggleClass("supports-drag-drop",!!e),!e)return i.unbind(".wp-uploader");i.on("dragover.wp-uploader",(function(){a&&clearTimeout(a),o||(i.trigger("dropzone:enter").addClass("drag-over"),o=!0)})),i.on("dragleave.wp-uploader, drop.wp-uploader",(function(){a=setTimeout((function(){o=!1,i.trigger("dropzone:leave").removeClass("drag-over")}),0)})),p.ready=!0,t(p).trigger("uploader:ready")}})),this.uploader.bind("postinit",(function(e){e.refresh(),p.init()})),this.uploader.init(),this.browser?this.browser.on("mouseenter",this.refresh):this.uploader.disableBrowse(!0),t(p).on("uploader:ready",(function(){t('.moxie-shim-html5 input[type="file"]').attr({tabIndex:"-1","aria-hidden":"true"})})),this.uploader.bind("FilesAdded",(function(e,t){_.each(t,(function(t){var a,o;if(plupload.FAILED!==t.status){if("image/heic"===t.type&&e.settings.heic_upload_error)r.errors.unshift({message:pluploadL10n.unsupported_image,data:{},file:t});else if("image/webp"===t.type&&e.settings.webp_upload_error)return i(pluploadL10n.noneditable_image,{},t,"no-retry"),void e.removeFile(t);a=_.extend({file:t,uploading:!0,date:new Date,filename:t.name,menuOrder:0,uploadedTo:wp.media.model.settings.post.id},_.pick(t,"loaded","size","percent")),(o=/(?:jpe?g|png|gif)$/i.exec(t.name))&&(a.type="image",a.subtype="jpg"===o[0]?"jpeg":o[0]),t.attachment=wp.media.model.Attachment.create(a),r.queue.add(t.attachment),p.added(t.attachment)}})),e.refresh(),e.start()})),this.uploader.bind("UploadProgress",(function(e,t){t.attachment.set(_.pick(t,"loaded","percent")),p.progress(t.attachment)})),this.uploader.bind("FileUploaded",(function(e,t,r){try{r=JSON.parse(r.response)}catch(e){return i(pluploadL10n.default_error,e,t)}return!_.isObject(r)||_.isUndefined(r.success)?i(pluploadL10n.default_error,null,t):r.success?void n(e,t,r):i(r.data&&r.data.message,r.data,t)})),this.uploader.bind("Error",(function(e,t){var a,o=pluploadL10n.default_error;for(a in r.errorMap)if(t.code===plupload[a]){"function"==typeof(o=r.errorMap[a])&&(o=o(t.file,t));break}i(o,t,t.file),e.refresh()})))}},_wpPluploadSettings),r.uuid=0,r.errorMap={FAILED:pluploadL10n.upload_failed,FILE_EXTENSION_ERROR:pluploadL10n.invalid_filetype,IMAGE_FORMAT_ERROR:pluploadL10n.not_an_image,IMAGE_MEMORY_ERROR:pluploadL10n.image_memory_exceeded,IMAGE_DIMENSIONS_ERROR:pluploadL10n.image_dimensions_exceeded,GENERIC_ERROR:pluploadL10n.upload_failed,IO_ERROR:pluploadL10n.io_error,SECURITY_ERROR:pluploadL10n.security_error,FILE_SIZE_ERROR:function(e){return pluploadL10n.file_exceeds_size_limit.replace("%s",e.name)},HTTP_ERROR:function(e){return e.type&&0===e.type.indexOf("image/")?pluploadL10n.http_error_image:pluploadL10n.http_error}},t.extend(r.prototype,{param:function(e,r){if(1===arguments.length&&"string"==typeof e)return this.uploader.settings.multipart_params[e];1<arguments.length?this.uploader.settings.multipart_params[e]=r:t.extend(this.uploader.settings.multipart_params,e)},init:function(){},error:function(){},success:function(){},added:function(){},progress:function(){},complete:function(){},refresh:function(){var e,r,a;if(this.browser){for(e=this.browser[0];e;){if(e===document.body){r=!0;break}e=e.parentNode}r||(a="wp-uploader-browser-"+this.uploader.id,(a=(a=t("#"+a)).length?a:t('<div class="wp-uploader-browser" />').css({position:"fixed",top:"-1000px",left:"-1000px",height:0,width:0}).attr("id","wp-uploader-browser-"+this.uploader.id).appendTo("body")).append(this.browser))}this.uploader.refresh()}}),r.queue=new wp.media.model.Attachments([],{query:!1}),r.errors=new Backbone.Collection,e.Uploader=r)}(wp,jQuery);