window.wp=window.wp||{},function(e,t){var a;"undefined"!=typeof _wpPluploadSettings&&(a=function(e){var r,o,n,i,d=this,s={container:"container",browser:"browse_button",dropzone:"drop_element"},p={};if(this.supports={upload:a.browser.supported},this.supported=this.supports.upload,this.supported){for(o in this.plupload=t.extend(!0,{multipart_params:{}},a.defaults),this.container=document.body,t.extend(!0,this,e),this)"function"==typeof this[o]&&(this[o]=t.proxy(this[o],this));for(o in s)this[o]&&(this[o]=t(this[o]).first(),this[o].length?(this[o].prop("id")||this[o].prop("id","__wp-uploader-id-"+a.uuid++),this.plupload[s[o]]=this[o].prop("id")):delete this[o]);(this.browser&&this.browser.length||this.dropzone&&this.dropzone.length)&&(this.uploader=new plupload.Uploader(this.plupload),delete this.plupload,this.param(this.params||{}),delete this.params,r=function(e,a,o){var s,l;if(a&&a.responseHeaders)if((l=a.responseHeaders.match(/x-wp-upload-attachment-id:\s*(\d+)/i))&&l[1]){if(l=l[1],(s=p[o.id])&&s>4)return t.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"media-create-image-subsizes",_wpnonce:_wpPluploadSettings.defaults.multipart_params._wpnonce,attachment_id:l,_wp_upload_failed_cleanup:!0}}),void n(e,a,o,"no-retry");p[o.id]=s?++s:1,t.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"media-create-image-subsizes",_wpnonce:_wpPluploadSettings.defaults.multipart_params._wpnonce,attachment_id:l}}).done((function(t){t.success?i(d.uploader,o,t):(t.data&&t.data.message&&(e=t.data.message),n(e,a,o,"no-retry"))})).fail((function(t){t.status>=500&&t.status<600?r(e,a,o):n(e,a,o,"no-retry")}))}else n(pluploadL10n.http_error_image,a,o,"no-retry");else n(pluploadL10n.http_error_image,a,o,"no-retry")},n=function(e,t,o,n){var i=o.type&&0===o.type.indexOf("image/"),s=t&&t.status;"no-retry"!==n&&i&&s>=500&&s<600?r(e,t,o):(o.attachment&&o.attachment.destroy(),a.errors.unshift({message:e||pluploadL10n.default_error,data:t,file:o}),d.error(e,t,o))},i=function(e,t,r){_.each(["file","loaded","size","percent"],(function(e){t.attachment.unset(e)})),t.attachment.set(_.extend(r.data,{uploading:!1})),wp.media.model.Attachment.get(r.data.id,t.attachment),a.queue.all((function(e){return!e.get("uploading")}))&&a.queue.reset(),d.success(t.attachment)},this.uploader.bind("init",(function(e){var r,o,n,i,s=d.dropzone;if(n=d.supports.dragdrop=e.features.dragdrop&&!a.browser.mobile,(i=new MutationObserver((function(){if(document.getElementById("menu-item-gallery-edit")||document.getElementById("menu-item-playlist-edit")||document.getElementById("menu-item-video-playlist-edit"))return i.disconnect(),s.unbind(".wp-uploader")}))).observe(document,{attributes:!1,childList:!0,subtree:!0}),s){if(s.toggleClass("supports-drag-drop",!!n),!n)return s.unbind(".wp-uploader");s.on("dragover.wp-uploader",(function(){r&&clearTimeout(r),o||(s.trigger("dropzone:enter").addClass("drag-over"),o=!0)})),s.on("dragleave.wp-uploader, drop.wp-uploader",(function(){r=setTimeout((function(){o=!1,s.trigger("dropzone:leave").removeClass("drag-over")}),0)})),d.ready=!0,t(d).trigger("uploader:ready")}})),this.uploader.bind("postinit",(function(e){e.refresh(),d.init()})),thatUploader=this.uploader,uploadCatSelect=document.getElementById("upload-category"),plUploader=document.querySelector(".uploader-inline"),null==uploadCatSelect?thatUploader.init():(uploadCatValue=uploadCatSelect.value,""==uploadCatSelect.value?(plUploader&&plUploader.setAttribute("inert",!0),window.addEventListener("dragover",(function(e){e.preventDefault()}),!1),window.addEventListener("drop",(function(e){e.preventDefault()}),!1)):thatUploader.init(),uploadCatSelect.addEventListener("change",(function(e){var t,a=new URLSearchParams({action:"media-cat-upload",option:"media_cat_upload_folder",media_cat_upload_value:e.target.value,media_cat_upload_nonce:document.getElementById("media_cat_upload_nonce").value});""==e.target.value?uploadCatSelect.value=uploadCatValue:(uploadCatValue=e.target.value,null!=document.getElementById("message")&&document.getElementById("message").remove(),fetch(ajaxurl,{method:"POST",body:a,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(a){a.success&&(null!=document.getElementById("message")&&document.getElementById("message").remove(),""==a.data.value?((t=document.createElement("div")).id="message",t.className="notice notice-error is-dismissible",t.innerHTML="<p>"+a.data.message+'</p><button class="notice-dismiss" type="button"></button>',document.querySelector(".page-title-action").after(t),null!=plUploader&&plUploader.setAttribute("inert",!0),thatUploader.destroy(),window.addEventListener("dragover",(function(e){e.preventDefault()}),!1),window.addEventListener("drop",(function(e){e.preventDefault()}),!1)):((t=document.createElement("div")).id="message",t.className="updated notice notice-success is-dismissible",t.innerHTML="<p>"+a.data.message+'</p><button class="notice-dismiss" type="button"></button>',document.querySelector(".page-title-action").after(t),uploadCatSelect.childNodes.forEach((function(t){t.value===e.target.value?t.setAttribute("selected",!0):t.removeAttribute("selected")})),null!=plUploader&&plUploader.removeAttribute("inert"),thatUploader.init||thatUploader.init()))}))["catch"]((function(e){null!=document.getElementById("message")&&document.getElementById("message").remove(),(t=document.createElement("div")).id="message",t.className="notice notice-error is-dismissible",t.innerHTML="<p>"+e+'</p><button class="notice-dismiss" type="button"></button>',document.querySelector(".page-title-action").after(t)})))}))),document.addEventListener("click",(function(e){"notice-dismiss"===e.target.className&&document.querySelector(".is-dismissible").remove()})),this.browser?this.browser.on("mouseenter",this.refresh):thatUploader.disableBrowse(!0),t(d).on("uploader:ready",(function(){t('.moxie-shim-html5 input[type="file"]').attr({tabIndex:"-1","aria-hidden":"true"})})),this.uploader.bind("FilesAdded",(function(e,t){_.each(t,(function(t){var r,o;if(plupload.FAILED!==t.status){if("image/heic"===t.type&&e.settings.heic_upload_error)a.errors.unshift({message:pluploadL10n.unsupported_image,data:{},file:t});else if("image/webp"===t.type&&e.settings.webp_upload_error)return n(pluploadL10n.noneditable_image,{},t,"no-retry"),void e.removeFile(t);r=_.extend({file:t,uploading:!0,date:new Date,filename:t.name,menuOrder:0,uploadedTo:wp.media.model.settings.post.id},_.pick(t,"loaded","size","percent")),(o=/(?:jpe?g|png|gif)$/i.exec(t.name))&&(r.type="image",r.subtype="jpg"===o[0]?"jpeg":o[0]),t.attachment=wp.media.model.Attachment.create(r),a.queue.add(t.attachment),d.added(t.attachment)}})),e.refresh(),e.start()})),this.uploader.bind("UploadProgress",(function(e,t){t.attachment.set(_.pick(t,"loaded","percent")),d.progress(t.attachment)})),this.uploader.bind("FileUploaded",(function(e,t,a){try{a=JSON.parse(a.response)}catch(r){return n(pluploadL10n.default_error,r,t)}return!_.isObject(a)||_.isUndefined(a.success)?n(pluploadL10n.default_error,null,t):a.success?void i(e,t,a):n(a.data&&a.data.message,a.data,t)})),this.uploader.bind("Error",(function(e,t){var r,o=pluploadL10n.default_error;for(r in a.errorMap)if(t.code===plupload[r]){"function"==typeof(o=a.errorMap[r])&&(o=o(t.file,t));break}n(o,t,t.file),e.refresh()})))}},t.extend(a,_wpPluploadSettings),a.uuid=0,a.errorMap={FAILED:pluploadL10n.upload_failed,FILE_EXTENSION_ERROR:pluploadL10n.invalid_filetype,IMAGE_FORMAT_ERROR:pluploadL10n.not_an_image,IMAGE_MEMORY_ERROR:pluploadL10n.image_memory_exceeded,IMAGE_DIMENSIONS_ERROR:pluploadL10n.image_dimensions_exceeded,GENERIC_ERROR:pluploadL10n.upload_failed,IO_ERROR:pluploadL10n.io_error,SECURITY_ERROR:pluploadL10n.security_error,FILE_SIZE_ERROR:function(e){return pluploadL10n.file_exceeds_size_limit.replace("%s",e.name)},HTTP_ERROR:function(e){return e.type&&0===e.type.indexOf("image/")?pluploadL10n.http_error_image:pluploadL10n.http_error}},t.extend(a.prototype,{param:function(e,a){if(1===arguments.length&&"string"==typeof e)return this.uploader.settings.multipart_params[e];arguments.length>1?this.uploader.settings.multipart_params[e]=a:t.extend(this.uploader.settings.multipart_params,e)},init:function(){},error:function(){},success:function(){},added:function(){},progress:function(){},complete:function(){},refresh:function(){var e,a,r,o;if(this.browser){for(e=this.browser[0];e;){if(e===document.body){a=!0;break}e=e.parentNode}a||(o="wp-uploader-browser-"+this.uploader.id,(r=t("#"+o)).length||(r=t('<div class="wp-uploader-browser" />').css({position:"fixed",top:"-1000px",left:"-1000px",height:0,width:0}).attr("id","wp-uploader-browser-"+this.uploader.id).appendTo("body")),r.append(this.browser))}this.uploader.refresh()}}),a.queue=new wp.media.model.Attachments([],{query:!1}),a.errors=new Backbone.Collection,e.Uploader=a)}(wp,jQuery),window.wp=window.wp||{},function(e,t){var a;"undefined"!=typeof _wpPluploadSettings&&(t.extend(a=function(e){var r,o,n,i,d=this,s={container:"container",browser:"browse_button",dropzone:"drop_element"},p={};if(this.supports={upload:a.browser.supported},this.supported=this.supports.upload,this.supported){for(o in this.plupload=t.extend(!0,{multipart_params:{}},a.defaults),this.container=document.body,t.extend(!0,this,e),this)"function"==typeof this[o]&&(this[o]=t.proxy(this[o],this));for(o in s)this[o]&&(this[o]=t(this[o]).first(),this[o].length?(this[o].prop("id")||this[o].prop("id","__wp-uploader-id-"+a.uuid++),this.plupload[s[o]]=this[o].prop("id")):delete this[o]);(this.browser&&this.browser.length||this.dropzone&&this.dropzone.length)&&(this.uploader=new plupload.Uploader(this.plupload),delete this.plupload,this.param(this.params||{}),delete this.params,r=function(e,a,o){var s,l;a&&a.responseHeaders&&(l=a.responseHeaders.match(/x-wp-upload-attachment-id:\s*(\d+)/i))&&l[1]?(l=l[1],(s=p[o.id])&&4<s?(t.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"media-create-image-subsizes",_wpnonce:_wpPluploadSettings.defaults.multipart_params._wpnonce,attachment_id:l,_wp_upload_failed_cleanup:!0}}),n(e,a,o,"no-retry")):(p[o.id]=s?++s:1,t.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"media-create-image-subsizes",_wpnonce:_wpPluploadSettings.defaults.multipart_params._wpnonce,attachment_id:l}}).done((function(t){t.success?i(d.uploader,o,t):(t.data&&t.data.message&&(e=t.data.message),n(e,a,o,"no-retry"))})).fail((function(t){500<=t.status&&t.status<600?r(e,a,o):n(e,a,o,"no-retry")})))):n(pluploadL10n.http_error_image,a,o,"no-retry")},n=function(e,t,o,n){var i=o.type&&0===o.type.indexOf("image/"),s=t&&t.status;"no-retry"!==n&&i&&500<=s&&s<600?r(e,t,o):(o.attachment&&o.attachment.destroy(),a.errors.unshift({message:e||pluploadL10n.default_error,data:t,file:o}),d.error(e,t,o))},i=function(e,t,r){_.each(["file","loaded","size","percent"],(function(e){t.attachment.unset(e)})),t.attachment.set(_.extend(r.data,{uploading:!1})),wp.media.model.Attachment.get(r.data.id,t.attachment),a.queue.all((function(e){return!e.get("uploading")}))&&a.queue.reset(),d.success(t.attachment)},this.uploader.bind("init",(function(e){var r,o,n=d.dropzone;e=d.supports.dragdrop=e.features.dragdrop&&!a.browser.mobile;if(n){if(n.toggleClass("supports-drag-drop",!!e),!e)return n.unbind(".wp-uploader");n.on("dragover.wp-uploader",(function(){r&&clearTimeout(r),o||(n.trigger("dropzone:enter").addClass("drag-over"),o=!0)})),n.on("dragleave.wp-uploader, drop.wp-uploader",(function(){r=setTimeout((function(){o=!1,n.trigger("dropzone:leave").removeClass("drag-over")}),0)})),d.ready=!0,t(d).trigger("uploader:ready")}})),this.uploader.bind("postinit",(function(e){e.refresh(),d.init()})),this.uploader.init(),this.browser?this.browser.on("mouseenter",this.refresh):this.uploader.disableBrowse(!0),t(d).on("uploader:ready",(function(){t('.moxie-shim-html5 input[type="file"]').attr({tabIndex:"-1","aria-hidden":"true"})})),this.uploader.bind("FilesAdded",(function(e,t){_.each(t,(function(t){var r,o;if(plupload.FAILED!==t.status){if("image/heic"===t.type&&e.settings.heic_upload_error)a.errors.unshift({message:pluploadL10n.unsupported_image,data:{},file:t});else if("image/webp"===t.type&&e.settings.webp_upload_error)return n(pluploadL10n.noneditable_image,{},t,"no-retry"),void e.removeFile(t);r=_.extend({file:t,uploading:!0,date:new Date,filename:t.name,menuOrder:0,uploadedTo:wp.media.model.settings.post.id},_.pick(t,"loaded","size","percent")),(o=/(?:jpe?g|png|gif)$/i.exec(t.name))&&(r.type="image",r.subtype="jpg"===o[0]?"jpeg":o[0]),t.attachment=wp.media.model.Attachment.create(r),a.queue.add(t.attachment),d.added(t.attachment)}})),e.refresh(),e.start()})),this.uploader.bind("UploadProgress",(function(e,t){t.attachment.set(_.pick(t,"loaded","percent")),d.progress(t.attachment)})),this.uploader.bind("FileUploaded",(function(e,t,a){try{a=JSON.parse(a.response)}catch(e){return n(pluploadL10n.default_error,e,t)}return!_.isObject(a)||_.isUndefined(a.success)?n(pluploadL10n.default_error,null,t):a.success?void i(e,t,a):n(a.data&&a.data.message,a.data,t)})),this.uploader.bind("Error",(function(e,t){var r,o=pluploadL10n.default_error;for(r in a.errorMap)if(t.code===plupload[r]){"function"==typeof(o=a.errorMap[r])&&(o=o(t.file,t));break}n(o,t,t.file),e.refresh()})))}},_wpPluploadSettings),a.uuid=0,a.errorMap={FAILED:pluploadL10n.upload_failed,FILE_EXTENSION_ERROR:pluploadL10n.invalid_filetype,IMAGE_FORMAT_ERROR:pluploadL10n.not_an_image,IMAGE_MEMORY_ERROR:pluploadL10n.image_memory_exceeded,IMAGE_DIMENSIONS_ERROR:pluploadL10n.image_dimensions_exceeded,GENERIC_ERROR:pluploadL10n.upload_failed,IO_ERROR:pluploadL10n.io_error,SECURITY_ERROR:pluploadL10n.security_error,FILE_SIZE_ERROR:function(e){return pluploadL10n.file_exceeds_size_limit.replace("%s",e.name)},HTTP_ERROR:function(e){return e.type&&0===e.type.indexOf("image/")?pluploadL10n.http_error_image:pluploadL10n.http_error}},t.extend(a.prototype,{param:function(e,a){if(1===arguments.length&&"string"==typeof e)return this.uploader.settings.multipart_params[e];1<arguments.length?this.uploader.settings.multipart_params[e]=a:t.extend(this.uploader.settings.multipart_params,e)},init:function(){},error:function(){},success:function(){},added:function(){},progress:function(){},complete:function(){},refresh:function(){var e,a,r;if(this.browser){for(e=this.browser[0];e;){if(e===document.body){a=!0;break}e=e.parentNode}a||(r="wp-uploader-browser-"+this.uploader.id,(r=(r=t("#"+r)).length?r:t('<div class="wp-uploader-browser" />').css({position:"fixed",top:"-1000px",left:"-1000px",height:0,width:0}).attr("id","wp-uploader-browser-"+this.uploader.id).appendTo("body")).append(this.browser))}this.uploader.refresh()}}),a.queue=new wp.media.model.Attachments([],{query:!1}),a.errors=new Backbone.Collection,e.Uploader=a)}(wp,jQuery);